/**
*  Contemplate
*  Light-weight Template Engine for PHP, Python, Node and client-side JavaScript
*
*  @version: 0.6.11
*  https://github.com/foo123/Contemplate
*
*  @inspired by : Simple JavaScript Templating, John Resig - http://ejohn.org/ - MIT Licensed
*  http://ejohn.org/blog/javascript-micro-templating/
*
**/
!function(e,t,n){"use strict";var r,u="object"==typeof module&&module.exports,i="function"==typeof define&&define.amd;u?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||n.call(e,{NODE:module})||1:i&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,r,u){return n.call(e,{AMD:u})}):t in e||(e[t]=r=n.call(e,{})||1)&&i&&define(t,[],function(){return r})}(this,"Contemplate",function(){"use strict";function e(t,n){var r,u=null,i=null;if(u=isNaN(t)?t?t.toUpperCase():"HTML_SPECIALCHARS":e.constMappingTable[t],i=isNaN(n)?n?n.toUpperCase():"ENT_COMPAT":e.constMappingQuoteStyle[n],"HTML_SPECIALCHARS"!==u&&"HTML_ENTITIES"!==u)throw new Error("Table: "+u+" not supported");if(r=u+"__"+i,e.tbls[r])return e.tbls[r];var o,l={},a={};l[38]="&amp;","HTML_ENTITIES"===u&&(l[160]="&nbsp;",l[161]="&iexcl;",l[162]="&cent;",l[163]="&pound;",l[164]="&curren;",l[165]="&yen;",l[166]="&brvbar;",l[167]="&sect;",l[168]="&uml;",l[169]="&copy;",l[170]="&ordf;",l[171]="&laquo;",l[172]="&not;",l[173]="&shy;",l[174]="&reg;",l[175]="&macr;",l[176]="&deg;",l[177]="&plusmn;",l[178]="&sup2;",l[179]="&sup3;",l[180]="&acute;",l[181]="&micro;",l[182]="&para;",l[183]="&middot;",l[184]="&cedil;",l[185]="&sup1;",l[186]="&ordm;",l[187]="&raquo;",l[188]="&frac14;",l[189]="&frac12;",l[190]="&frac34;",l[191]="&iquest;",l[192]="&Agrave;",l[193]="&Aacute;",l[194]="&Acirc;",l[195]="&Atilde;",l[196]="&Auml;",l[197]="&Aring;",l[198]="&AElig;",l[199]="&Ccedil;",l[200]="&Egrave;",l[201]="&Eacute;",l[202]="&Ecirc;",l[203]="&Euml;",l[204]="&Igrave;",l[205]="&Iacute;",l[206]="&Icirc;",l[207]="&Iuml;",l[208]="&ETH;",l[209]="&Ntilde;",l[210]="&Ograve;",l[211]="&Oacute;",l[212]="&Ocirc;",l[213]="&Otilde;",l[214]="&Ouml;",l[215]="&times;",l[216]="&Oslash;",l[217]="&Ugrave;",l[218]="&Uacute;",l[219]="&Ucirc;",l[220]="&Uuml;",l[221]="&Yacute;",l[222]="&THORN;",l[223]="&szlig;",l[224]="&agrave;",l[225]="&aacute;",l[226]="&acirc;",l[227]="&atilde;",l[228]="&auml;",l[229]="&aring;",l[230]="&aelig;",l[231]="&ccedil;",l[232]="&egrave;",l[233]="&eacute;",l[234]="&ecirc;",l[235]="&euml;",l[236]="&igrave;",l[237]="&iacute;",l[238]="&icirc;",l[239]="&iuml;",l[240]="&eth;",l[241]="&ntilde;",l[242]="&ograve;",l[243]="&oacute;",l[244]="&ocirc;",l[245]="&otilde;",l[246]="&ouml;",l[247]="&divide;",l[248]="&oslash;",l[249]="&ugrave;",l[250]="&uacute;",l[251]="&ucirc;",l[252]="&uuml;",l[253]="&yacute;",l[254]="&thorn;",l[255]="&yuml;"),"ENT_NOQUOTES"!==i&&(l[34]="&quot;"),"ENT_QUOTES"===i&&(l[39]="&#39;"),l[60]="&lt;",l[62]="&gt;";for(o in l)l.hasOwnProperty(o)&&(a[String.fromCharCode(o)]=l[o]);return"ENT_QUOTES"===i&&(a["'"]="&#039;"),e.tbls[r]=a}function t(t,n,r,u){var i=e("HTML_ENTITIES",n),o="";if(t=null==t?"":t+"",!i)return!1;if(u||null==u)for(o in i)i.hasOwnProperty(o)&&(t=t.split(o).join(i[o]));else t=t.replace(/([\s\S]*?)(&(?:#\d+|#x[\da-f]+|[a-zA-Z][\da-z]*);|$)/g,function(e,t,n){for(o in i)i.hasOwnProperty(o)&&(t=t.split(o).join(i[o]));return t+n});return t}function n(e){return e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function r(e){return null===e||"undefined"==typeof e?0:Array===e.constructor?e.length:Object===e.constructor?O(e).length:1}function u(e){return e instanceof Array||"[object Array]"===T(e)}function i(e){var t,n,r={},u=O(e),i=u.length;for(t=0;i>t;t++)n=u[t],r[e[n]]=n;return r}function o(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,n=0,r=t[n++],u=function(e,t,n,r){n||(n=" ");var u=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return r?e+u:u+e},i=function(e,t,n,r,i,o){var l=r-e.length;return l>0&&(e=n||!i?u(e,r,o,n):e.slice(0,t.length)+u("",l,"0",!0)+e.slice(t.length)),e},o=function(e,t,n,r,o,l,a){var s=e>>>0;return n=n&&s&&{2:"0b",8:"0",16:"0x"}[t]||"",e=n+u(s.toString(t),l||0,"0",!1),i(e,n,r,o,a)},l=function(e,t,n,r,u,o){return null!=r&&(e=e.slice(0,r)),i(e,"",t,n,u,o)},a=function(e,r,a,s,c,f,d){var p,_,g,h,m;if("%%"==e)return"%";for(var v=!1,O="",E=!1,C=!1,b=" ",T=a.length,A=0;a&&T>A;A++)switch(a.charAt(A)){case" ":O=" ";break;case"+":O="+";break;case"-":v=!0;break;case"'":b=a.charAt(A+1);break;case"0":E=!0;break;case"#":C=!0}if(s=s?"*"==s?+t[n++]:"*"==s.charAt(0)?+t[s.slice(1,-1)]:+s:0,0>s&&(s=-s,v=!0),!isFinite(s))throw new Error("sprintf: (minimum-)width must be finite");switch(f=f?"*"==f?+t[n++]:"*"==f.charAt(0)?+t[f.slice(1,-1)]:+f:"fFeE".indexOf(d)>-1?6:"d"==d?0:void 0,m=r?t[r.slice(0,-1)]:t[n++],d){case"s":return l(String(m),v,s,f,E,b);case"c":return l(String.fromCharCode(+m),v,s,f,E);case"b":return o(m,2,C,v,s,f,E);case"o":return o(m,8,C,v,s,f,E);case"x":return o(m,16,C,v,s,f,E);case"X":return o(m,16,C,v,s,f,E).toUpperCase();case"u":return o(m,10,C,v,s,f,E);case"i":case"d":return p=+m||0,p=Math.round(p-p%1),_=0>p?"-":O,m=_+u(String(Math.abs(p)),f,"0",!1),i(m,_,v,s,E);case"e":case"E":case"f":case"F":case"g":case"G":return p=+m,_=0>p?"-":O,g=["toExponential","toFixed","toPrecision"]["efg".indexOf(d.toLowerCase())],h=["toString","toUpperCase"]["eEfFgG".indexOf(d)%2],m=_+Math.abs(p)[g](f),i(m,_,v,s,E)[h]();default:return e}};return r.replace(e,a)}function l(e,t){t=t?(t+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \\s ";var n=new RegExp("^["+t+"]+","g");return(e+"").replace(n,"")}function a(e,t){t=t?(t+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1"):" \\s ";var n=new RegExp("["+t+"]+$","g");return(e+"").replace(n,"")}function s(e,t){var n,r=0,u=0;for(e+="",t?(t+="",n=t.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")):n=" \n\r	\f            ​\u2028\u2029　",r=e.length,u=0;r>u;u++)if(-1===n.indexOf(e.charAt(u))){e=e.substring(u);break}for(r=e.length,u=r-1;u>=0;u--)if(-1===n.indexOf(e.charAt(u))){e=e.substring(0,u+1);break}return-1===n.indexOf(e.charAt(0))?e:""}function c(){return Math.floor((new Date).getTime()/1e3)}function f(e,t){var n,r,u,i=/\\?([a-z])/gi,o=function(e,t){return e=e.toString(),e.length<t?o("0"+e,t,"0"):e},l=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];u=function(e,t){return r[e]?r[e]():t},r={d:function(){return o(r.j(),2)},D:function(){return r.l().slice(0,3)},j:function(){return n.getDate()},l:function(){return l[r.w()]+"day"},N:function(){return r.w()||7},S:function(){var e=r.j();return 4>e|e>20&&(["st","nd","rd"][e%10-1]||"th")},w:function(){return n.getDay()},z:function(){var e=new Date(r.Y(),r.n()-1,r.j()),t=new Date(r.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(r.Y(),r.n()-1,r.j()-r.N()+3),t=new Date(e.getFullYear(),0,4);return o(1+Math.round((e-t)/864e5/7),2)},F:function(){return l[6+r.n()]},m:function(){return o(r.n(),2)},M:function(){return r.F().slice(0,3)},n:function(){return n.getMonth()+1},t:function(){return new Date(r.Y(),r.n(),0).getDate()},L:function(){var e=r.Y();return e%4===0&e%100!==0|e%400===0},o:function(){var e=r.n(),t=r.W(),n=r.Y();return n+(12===e&&9>t?1:1===e&&t>9?-1:0)},Y:function(){return n.getFullYear()},y:function(){return r.Y().toString().slice(-2)},a:function(){return n.getHours()>11?"pm":"am"},A:function(){return r.a().toUpperCase()},B:function(){var e=3600*n.getUTCHours(),t=60*n.getUTCMinutes(),r=n.getUTCSeconds();return o(Math.floor((e+t+r+3600)/86.4)%1e3,3)},g:function(){return r.G()%12||12},G:function(){return n.getHours()},h:function(){return o(r.g(),2)},H:function(){return o(r.G(),2)},i:function(){return o(n.getMinutes(),2)},s:function(){return o(n.getSeconds(),2)},u:function(){return o(1e3*n.getMilliseconds(),6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var e=new Date(r.Y(),0),t=Date.UTC(r.Y(),0),n=new Date(r.Y(),6),u=Date.UTC(r.Y(),6);return e-t!==n-u?1:0},O:function(){var e=n.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+o(100*Math.floor(t/60)+t%60,4)},P:function(){var e=r.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-n.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(i,u)},r:function(){return"D, d M Y H:i:s O".replace(i,u)},U:function(){return n/1e3|0}};var a=function(e,t){return n=void 0===t?new Date:new Date(t instanceof Date?t:1e3*t),e.replace(i,u)};return a(e,t)}function d(e,t,n){for(var r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=f(t,n),i=0,o=r.length;o>i;i++)e[r[i]]&&(u=u.replace(r[i],e[r[i]]));return u}var p,_="0.6.11",g=Object,h=Array,m=String,v=Function,O=g.keys,E=g.prototype,C=h.prototype,b=v.prototype,T=b.call.bind(E.toString),A=b.call.bind(E.hasOwnProperty),S=b.call.bind(C.slice),y="undefined"!=typeof global&&"[object global]"===T(global),D=function(e){return e instanceof h||"[object Array]"===T(e)},w="undefined"!=typeof navigator?navigator.userAgent:"",N=(/Chrome\//.test(w),y?require("fs"):null),M=N?N.writeFileSync:null,j=N?N.readFileSync:null,k=N?N.existsSync:null,x=N?N.statSync:null,I=(N?N.realpathSync:null,N?N.writeFile:null),L=N?N.readFile:null,K=(N?N.exists:null,N?N.stat:null,N?N.realpath:null,function(e,t,n,r){var u;return u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r?(u.onload=function(){r(200===u.status?u.responseText:"")},u.open(e,t,!0),u.send(n),""):(u.open(e,t,!1),u.send(n),200===u.status?u.responseText:"")}),U=!1,H={},F={},R=!1,P=0,B="./",q={},$={},G={},Y="<%",z="%>",V="",J="",Q="",X="' + \"\\n\" + '",W="",Z=y?require("os").EOL:"\n",et=!0,tt=null,nt=0,rt="    ",ut=0,it=0,ot=0,lt=0,at=2,st=null,ct=null,ft=null,dt=null,pt=null,_t=-1,gt=null,ht=0,mt=/[ -]/g,vt=/\n\r|\r\n|\n|\r/g,Ot=/^[a-zA-Z_]/,Et=/^[0-9]/,Ct=/^[a-zA-Z0-9_]/i,bt=/^\s/,Tt={specials:null,replacements:null,functions:null,controls:null,controls2:null},At=["include","template","extends","endblock","block","elsefor","endfor","for","set","unset","isset","elseif","else","endif","if"],St=["htmlselect","htmltable","(plg_|plugin_)([a-zA-Z0-9_]+)","haskey","lowercase","uppercase","camelcase","snakecase","pluralise","concat","ltrim","rtrim","trim","sprintf","addslashes","stripslashes","tpl","uuid","html","url","count","ldate","date","now","locale","dq","q","l","s","n","f","e"],yt={},Dt=function(){it=0,ot=0,lt=0,at=2,nt=0,st=[],ct={},ft=[[null,-1]],gt=null},wt=function(){tt.push([it,ot,lt,at,nt,st,ct,ft,gt])},Nt=function(){var e=tt.pop();it=e[0],ot=e[1],lt=e[2],at=e[3],nt=e[4],st=e[5],ct=e[6],ft=e[7],gt=e[8]},Mt=function(){return S(arguments).join(Z)},jt=function(e,t){if(2>arguments.length&&(t=nt),t>=0){t=0===t?t:t+1;var n,r,u=new h(t).join(rt);for(e=e.split(vt),r=e.length,n=0;r>n;n++)e[n]=u+e[n];return e.join(Z)}return e},kt=function(){var e=S(arguments);if(!(e.length<1)){var t,n,r,u=e.shift(),i=e.length;for(t=0;i>t;t++)if(r=e[t])for(n in r)A(r,n)&&(u[n]=r[n]);return u}},xt=function(e,t){var n,r;if(t)r=s(t).split(" "),Y=s(r[0]),z=s(r[1]);else{for(n=e.split("\n");n.length&&!s(n[0]).length;)n.shift();n.length&&(r=s(n.shift()).split(" "),Y=s(r[0]),z=s(r[1])),e=n.join("\n")}return e},It=function(e){for(var t,n=0,r=e.length,u="";r>n;)switch(t=e.charAt(n++),t.charCodeAt(0)){case 34:u+="&quot;";break;case 38:u+="&amp;";break;case 39:u+="&#39;";break;case 60:u+="&lt;";break;case 62:u+="&gt;";break;default:u+=t}return u},Lt=function(e,t){var n;return(n=$[e])?n[1]?R&&t?(t(n[0]),""):n[0]:y&&N?R&&t?(L(n[0],{encoding:p.ENCODING},function(e,n){t(e?"":n)}),""):j(n[0],{encoding:p.ENCODING}):"#"===n[0].charAt(0)?R&&t?(t(window.document.getElementById(n[0].substring(1)).innerHTML||""),""):window.document.getElementById(n[0].substring(1)).innerHTML||"":R&&t?(K("GET",n[0],null,t),""):K("GET",n[0]):""},Kt=function(e){return' ("undefined" !== typeof('+e+")) "},Ut=function(e){e=e.split(",");var t=s(e.shift()),n=s(e.join(","));return"';"+Z+jt(t+" = ("+n+");")+Z},Ht=function(e){return e&&e.length?(e=s(e),"';"+Z+jt('if ("undefined" !== typeof('+e+")) delete "+e+";")+Z):"'; "+Z},Ft=function(e){var t="';"+jt(_n({IFCOND:e}));return ot++,nt++,t},Rt=function(e){nt--;var t="';"+jt(gn({ELIFCOND:e}));return nt++,t},Pt=function(){nt--;var e="';"+jt(hn());return nt++,e},Bt=function(){ot--,nt--;var e="';"+jt(mn());return e},qt=function(e){e=e.split(" as ");var t,n=s(e[0]),r="_O"+ ++ut,u=e[1].split("=>"),i=u.length>=2;if(i){var o=s(u[0])+"__RAW__",l=s(u[1])+"__RAW__",a="_OK"+ ++ut,c="_K"+ ++ut,f="_L"+ ++ut,d="_V"+ ++ut;t="';"+jt(vn({O:n,_O:r,_OK:a,K:o,_K:c,_L:f,V:l,_V:d,ASSIGN1:"data['"+o+"'] = "+a+"["+c+"]; data['"+l+"'] = "+d+" = "+r+"["+a+"["+c+"]];"},2)),at=2,nt+=2}else{var l=s(u[0])+"__RAW__",c="_K"+ ++ut,f="_L"+ ++ut,d="_V"+ ++ut;t="';"+jt(vn({O:n,_O:r,_K:c,_L:f,V:l,_V:d,ASSIGN1:"data['"+l+"'] = "+d+" = "+r+"["+c+"];"},1)),at=1,nt+=2}return it++,lt++,t},$t=function(){var e;return 2===at?(lt--,nt+=-2,e="';"+jt(On(null,2)),nt+=1):(lt--,nt+=-2,e="';"+jt(On(null,1)),nt+=1),e},Gt=function(){var e;return lt===it?2===at?(it--,lt--,nt+=-2,e="';"+jt(En(null,3))):(it--,lt--,nt+=-2,e="';"+jt(En(null,2))):(it--,nt+=-1,e="';"+jt(En(null,1))),e},Yt=function(e){return G[e]||(wt(),Dt(),G[e]=" "+rn(xt(Lt(e)),!1)+"'; "+Z,Nt()),jt(G[e])},zt=function(e){e=e.split(",");var t=s(e.shift()),n=e.join(",");return"' + %tpl( \""+t+'", '+n+" ); "+Z},Vt=function(e){return gt=s(e),"'; "+Z},Jt=function(e){return e=s(e),st.push([e,-1,-1,0,ft[0][1]]),ct[e]=ct[e]?ct[e]+1:1,_t=st.length,ft.unshift([e,_t-1]),dt=e,pt=null,"' +  __||"+e+"||__"},Qt=function(){if(1<ft.length){var e=ft.shift();return pt=e[0],_t=e[1]+1,dt=null,"__||/"+e[0]+"||__"}return""},Xt=function(e,t,n){var r,u,i,o,l;for(r=e.split(t),u=r.length,i=[],o=0;u>o;o++)l=r[o].split(n),i.push(l[0]),l.length>1&&i.push(l[1]);return i},Wt=function(e,t,n){if(t)switch(n=n||"",t){case"isset":return n=n.replace(Tt.controls2,Wt),Kt(n);case"set":return n=n.replace(Tt.controls2,Wt),Ut(n);case"unset":return n=n.replace(Tt.controls2,Wt),Ht(n);case"if":return n=n.replace(Tt.controls2,Wt),Ft(n);case"elseif":return n=n.replace(Tt.controls2,Wt),Rt(n);case"else":return Pt(n);case"endif":return Bt(n);case"for":return n=n.replace(Tt.controls2,Wt),qt(n);case"elsefor":return $t(n);case"endfor":return Gt(n);case"extends":return Vt(n);case"block":return Jt(n);case"endblock":return Qt(n);case"template":return n=n.replace(Tt.controls2,Wt),zt(n);case"include":return Yt(n)}return e},Zt=function(e){for(var t,n,r,u,i,o,l,a,s,c,f=[],d=st.length;d--;)n=st[d],t=n[0],l=n[1],a=n[2],s=n[3],c=n[4],r="__||"+t+"||__",u="__i__.renderBlock( '"+t+"' ); ",i=r.length,o=u.length,c>-1&&(st[c][3]+=o-(a-l+1)),a+=s,1===ct[t]&&f.push([t,pn({BLOCKCODE:e.slice(l+i,a-i-1)+"';"})]),e=e.slice(0,l)+u+e.slice(a+1),1<=ct[t]&&ct[t]--;return st=null,ct=null,ft=null,[e,f]},en=function(e,t,n,r){for(var u=t,i=!1,o="";r>n&&(u+=o=e[n++],t!==o||i);)i=!i&&"\\"===o;return u},tn=function(e,t,n,r){if(r=r||"VARSTR",Ot.test(e[t])){var u,i,o,l,a,s,c,f,d,p,_,g=0,h={},m=[],v=0;for(i=e[t++];n>t&&Ct.test(e[t]);)i+=e[t++];for(l=i,i="data['"+i+"']",a=l.length,v=0;n>t&&bt.test(e[t]);)v++,t++;for(c=0;n>t&&("."===e[t]||"["===e[t]);){for(f=e[t++];n>t&&bt.test(e[t]);)v++,t++;if("."===f){for(o="";n>t&&Ct.test(e[t]);)o+=e[t++];if(s=o.length,!s)break;i+="['"+o+"']",a+=v+1+s,v=0}else if("["===f){if(c++,d=e[t],'"'===d||"'"===d)o=en(e,d,t+1,n),g++,p="__##"+r+g+"##__",h[p]=o,i+=f+p,s=o.length,t+=s,a+=v+1+s,v=0;else if(Et.test(d)){for(o=e[t++];n>t&&Et.test(e[t]);)o+=e[t++];i+=f+o,s=o.length,a+=v+1+s,v=0}else if("$"===d)_=e.slice(t+1),u=tn(_,0,_.length,r+"_"+g+"_"),u&&(o=u[u.length-1],i+=f+o[0][0],s=o[1],t+=s+1,a+=v+2+s,v=0,m=m.concat(u));else{if("]"!==d)break;if(!(c>0))break;c--,i+=f+e[t++],a+=v+2,v=0}for(;n>t&&bt.test(e[t]);)v++,t++;if("]"===e[t]){if(!(c>0))break;c--,i+=e[t++],a+=v+1,v=0}}for(;n>t&&bt.test(e[t]);)v++,t++}return m.push([[i,l],a,h]),m}return null},nn=function(e,t,n,r){return r&&r in yt?yt[r]:"Contemplate."+t},rn=function(e,t){var n,r,u,i,o,l,a,s,c,f,d,_,g,h,m,v,O,E;for(n=Xt(e,Y,z),r=n.length,l=!1,u="",o=0;r>o;o++){if(i=n[o],l){for(a="	"+i.replace(Tt.specials," ")+"",d=a.length,c={},s={},_=0,g="",h="",m=0;d>_;)if(g=a[_++],'"'===g||"'"===g)v=en(a,g,_,d),m++,f="__##STR"+m+"##__",s[f]=v,h+=f,_+=v.length-1;else if("$"===g)if(v=tn(a,_,d)){for(O=0;O<v.length;O++)E=v[O],m++,f="__##VAR"+m+"##__",c[f]=E[0],s=p.merge(s,E[2]);h+=f,_+=E[1]}else h+="$";else h+=g;a=h,dt=null,pt=null,_t=-1,a=a.replace(Tt.controls,Wt).replace(Tt.functions,nn).replace(Tt.replacements,"' + ( $1 ) + '");for(f in c)a=a.split(f+"__RAW__").join(c[f][1]),a=a.split(f).join(c[f][0]);for(f in s)a=a.split(f).join(s[f]);i=a.split("	").join(V).split("").join(jt(J)),dt?(dt="__||"+dt+"||__",st[_t-1][1]=u.length+a.indexOf(dt)):pt&&(pt="__||/"+pt+"||__",st[_t-1][2]=u.length+a.indexOf(pt)+pt.length),l=!1}else et&&(i=i.split("\\").join("\\\\")),i=i.split("'").join("\\'").split(/\n/).join(W),l=!0;u+=i}return!1!==t?Zt(u):u},un=function(e){return B+e.replace(mt,"_")+"_tpl.js"},on=function(e){return"Contemplate_"+e.replace(mt,"_")+"_Cached"},ln=function(e,t){Dt();var n,r,u,i,o=rn(xt(Lt(e),t)),l={};for(i=o[0],o=o[1],r=o.length,u=gt?Cn(null,1):Cn({FCODE:"__p__ += '"+i+"';"},2),n=0;r>n;n++)l[o[n][0]]=new v("Contemplate,__i__",o[n][1]);return[new v("Contemplate,__i__",u),l]},an=function(e,t,n,r){Dt();var u,i,o,l,a,s,c,f=rn(xt(Lt(e),r));for(c=f[0],f=f[1],a=f.length,s=[],l=0;a>l;l++)s.push(Z+dn({BLOCKNAME:f[l][0],BLOCKMETHODNAME:f[l][0],BLOCKMETHODCODE:jt(f[l][1],1)}));s=s.length?Z+"_blocks = { "+Z+jt(s.join(","+Z),1)+Z+"};"+Z:"",gt?(i="this.extend( '"+gt+"' );",o=bn(null,1)):(i="",o=bn({RCODE:"__p__ += '"+c+"';"},2)),u=Q?Q:"";var d=fn({CLASSNAME:n,TPLID:e,PREFIXCODE:u,EXTENDCODE:jt(i,2),BLOCKS:jt(s,2),RENDERCODE:jt(o,4)});return cn(t,d)},sn=function(e,t){var n;if(n=$[e]){if(n[1]){var r,u;return t.parsed?u=Tn(p,e,new v("Contemplate,__i__",t.parsed)):(r=ln(e,t.separators),u=Tn(p,e,r[0]).setBlocks(r[1])),gt&&u.extend(p.tpl(gt)),u}if(y||(P=p.CACHE_TO_DISK_NONE),!0!==t.autoUpdate&&p.CACHE_TO_DISK_NOUPDATE===P){var i=un(e),o=on(e);if(k(i)||an(e,i,o,t.separators),k(i)){var l=require(i)(p),u=(new l).setId(e);return u}return null}if(!0===t.autoUpdate||p.CACHE_TO_DISK_AUTOUPDATE===P){var i=un(e),o=on(e);if(k(i)){var a=x(i),s=x(n[0]);a.mtime.getTime()<=s.mtime.getTime()&&an(e,i,o,t.separators)}else an(e,i,o,t.separators);if(k(i)){var l=require(i)(p),u=(new l).setId(e);return u}return null}var r=ln(e,t.separators),u=Tn(p,e,r[0]).setBlocks(r[1]);return gt&&u.extend(p.tpl(gt)),u}return null},cn=function(e,t,n){return n?void I(e,t,{encoding:p.ENCODING},function(e){n(!e)}):M(e,t,{encoding:p.ENCODING})},fn=function(e){var t=Mt;return[e.PREFIXCODE,t("","!function (root, moduleName, moduleDefinition) {","","    //","    // export the module","","    // node, CommonJS, etc..","    if ( 'object' === typeof(module) && module.exports ) module.exports = moduleDefinition();","","    // AMD, etc..","    else if ( 'function' === typeof(define) && define.amd ) define( moduleDefinition );","","    // browser, etc..","    else root[ moduleName ] = moduleDefinition();","","","}(this, '"),e.CLASSNAME,t("', function( ) {",'    "use strict";',"    return function( Contemplate ) {","    /* Contemplate cached template '"),e.TPLID,t("' */","    /* quasi extends main Contemplate class */","    ","    var Contemplate_tpl = Contemplate.tpl;","    ","    /* constructor */","    function "),e.CLASSNAME,t("(id)","    {","        /* initialize internal vars */","        var _extends = null, _blocks = null;","        ","        this.id = id;","        this.d = null;","        ","        ","        /* tpl-defined blocks render code starts here */",""),e.BLOCKS,t("","        /* tpl-defined blocks render code ends here */","        ","        /* template methods */","        ","        this.setId = function(id) {","            if ( id ) this.id = id;","            return this;","        };","        ","        this.extend = function(tpl) {","            if ( tpl && tpl.substr )","                _extends = Contemplate_tpl( tpl );","            else","                _extends = tpl;","            return this;","        };","        ","        /* render a tpl block method */","        this.renderBlock = function(block, __i__) {","            if ( !__i__ ) __i__ = this;","            if ( _blocks && _blocks[block] ) return _blocks[block](__i__);","            else if ( _extends ) return _extends.renderBlock(block, __i__);","            return '';","        };","        ","        /* tpl render method */","        this.render = function(data, __i__) {","            if ( !__i__ ) __i__ = this;","            var __p__ = '';","            if ( _extends )","            {","                __p__ = _extends.render(data, __i__);","            }","            else","            {","                /* tpl main render code starts here */",""),e.RENDERCODE,t("","                /* tpl main render code ends here */","            }","            this.d = null;","            return __p__;","        };","        ","        /* extend tpl assign code starts here */",""),e.EXTENDCODE,t("","        /* extend tpl assign code ends here */","    };","    ","    ","    // export it","    return "),e.CLASSNAME,t(";","    };","});","")].join("")},dn=function(e){var t=Mt;return[t("","/* tpl block render method for block '"),e.BLOCKNAME,t("' */","'"),e.BLOCKMETHODNAME,t("': function(__i__) {",""),e.BLOCKMETHODCODE,t("","}","")].join("")},pn=function(e){var t=Mt;return[t("","var __p__ = '', data = __i__.d;",""),e.BLOCKCODE,t("","return __p__;","")].join("")},_n=function(e){var t=Mt;return[t("","if ("),e.IFCOND,t(")","{","")].join("")},gn=function(e){var t=Mt;return[t("","}","else if ("),e.ELIFCOND,t(")","{","")].join("")},hn=function(){var e=Mt;return e("","}","else","{","")},mn=function(){var e=Mt;return e("","}","")},vn=function(e,t){var n=Mt;return 2===t?[n("","var "),e._O," = ",e.O,", ",e._OK," = Contemplate.keys(",e._O,n(");","if ("),e._OK," && ",e._OK,n(".length)","{","    var "),e._K,", ",e._V,", ",e._L," = ",e._OK,".length",n(";","    for ("),e._K,"=0; ",e._K,"<",e._L,"; ",e._K,n("++)","    {","        "),e.ASSIGN1,n("","        ","")].join(""):[n("","var "),e._O," = Contemplate.values(",e.O,n(");","if ("),e._O," && ",e._O,n(".length)","{","    var "),e._K,", ",e._V,", ",e._L," = ",e._O,".length",n(";","    for ("),e._K,"=0; ",e._K,"<",e._L,"; ",e._K,n("++)","    {","        "),e.ASSIGN1,n("","        ","")].join("")},On=function(e,t){var n=Mt;return 2===t?n("","    }","}","else","{  ",""):n("","    }","}","else","{  ","")},En=function(e,t){var n=Mt;return 3===t?n("","    }","}",""):2===t?n("","    }","}",""):n("","}","")},Cn=function(e,t){var n=Mt;return 1===t?"return '';":[n("","var __p__ = '', data = __i__.d;",""),e.FCODE,n("","return __p__;","")].join("")},bn=function(e,t){var n=Mt;return 1===t?"__p__ = '';":[n("","__i__.d = data;",""),e.RCODE,n("","")].join("")},Tn=function(e,t,n){var r=e.tpl,u=e.merge,i=function(t,n){var i=null,o=null,l=null;this.id=null,this.d=null,t&&(this.id=t,i=n),this.setId=function(e){return e&&(this.id=e),this},this.extend=function(e){return o=e&&e.substr?r(e):e,this},this.setRenderFunction=function(e){return i=e,this},this.setBlocks=function(e){return l||(l={}),l=u(l,e),this},this.renderBlock=function(t,n){return n||(n=this),l&&l[t]?l[t](e,n):o?o.renderBlock(t,n):""},this.render=function(t,n){var r="";return n||(n=this),o?r=o.render(t,n):i&&(n.d=t,r=i(e,n)),this.d=null,r}};return new i(t,n)};return p={VERSION:_,CACHE_TO_DISK_NONE:0,CACHE_TO_DISK_AUTOUPDATE:2,CACHE_TO_DISK_NOUPDATE:4,ENCODING:"utf8",init:function(){U||(tt=[],Tt.specials=new RegExp("[\\n\\r\\v\\t]","g"),Tt.replacements=new RegExp("\\t[ ]*(.*?)[ ]*\\v","g"),Tt.controls=new RegExp("\\t[ ]*%("+At.join("|")+")\\b[ ]*\\((.*)\\)","g"),Tt.controls2=new RegExp("%("+At.join("|")+")\\b[ ]*\\((.*)\\)","g"),Tt.functions=new RegExp("%("+St.join("|")+")\\b","g"),W=X,V="'; "+Z,J=Z+"__p__ += '",U=!0)},addPlugin:function(e,t,n){e&&(t||n)&&(n?yt[e]=n:(yt[e]="Contemplate.plg_"+e,p["plg_"+e]=t))},setPrefixCode:function(e){e&&(Q=""+e)},setLocaleStrings:function(e){H=p.merge(H,e)},clearLocaleStrings:function(){H={}},setPlurals:function(e){if(e){for(var t in e)null==e[t]&&(e[t]=t+"s");F=p.merge(F,e)}},clearPlurals:function(){F={}},setTemplateSeparators:function(e){e&&(e.left&&(Y=""+e.left),e.right&&(z=""+e.right))},setPreserveLines:function(e){arguments.length<1&&(e=!0),W=e?X:""},setCacheDir:function(e){B=a(e,"/")+"/"},setCacheMode:function(e){P=y?e:p.CACHE_TO_DISK_NONE},setSyncMode:function(e){R=!e},clearCache:function(e){q={},e&&(G={})},add:function(e,t){if("object"==typeof e)for(var n in e)D(e[n])?e[n][0]&&($[n]=[e[n][0],!0]):$[n]=[e[n],!1];else e&&t&&(D(t)?t[0]&&($[e]=[t[0],!0]):$[e]=[t,!1])},parseTpl:function(e,t){var n,r,u=t&&t.separators?t.separators:null;return u&&(n=[Y,z],Y=u[0],z=u[1]),Dt(),r=rn(e),u&&(Y=n[0],z=n[1]),r},tpl:function(e,t,n){n=kt({autoUpdate:!1,refresh:!1,escape:!0,separators:null},n),et=!1!==n.escape,(n.refresh||!q[e])&&(q[e]=sn(e,n));var r=q[e];return t&&"object"==typeof t?r.render(t):r},haskey:function(e){var t,n,r,u=T(e);if(!e||"[object Array]"!==u&&"[object Object]"!==u)return!1;for(t=arguments,r=e,n=1;n<t.length;n++){if(!(t[n]in r))return!1;r=r[t[n]]}return!0},q:function(e){return"'"+e+"'"},dq:function(e){return'"'+e+'"'},s:function(e){return m(e)},n:function(e){return parseInt(e,10)},f:function(e){return parseFloat(e,10)},e:It,html:function(e,n){return t(e,n||"ENT_COMPAT","UTF-8")},url:n,count:r,addslashes:function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},stripslashes:function(e){return(e+"").replace(/\\(.?)/g,function(e,t){switch(t){case"\\":return"\\";case"0":return"\x00";case"":return"";default:return t}})},concat:function(){return S(arguments).join("")},trim:s,ltrim:l,rtrim:a,ucfirst:function(e){return e[0].toUpperCase()+e.substr(1)},lcfirst:function(e){return e[0].toLowerCase()+e.substr(1)},lowercase:function(e){return e.toLowerCase()},uppercase:function(e){return e.toUpperCase()},camelcase:function(e,t,n){return t=t||"_",n?e.split(t).map(p.ucfirst).join(""):p.lcfirst(e.split(t).map(p.ucfirst).join(""))},snakecase:function(e,t){return t=t||"_",e.replace(/([A-Z])/g,t+"$1").toLowerCase()},sprintf:o,time:c,date:function(e,t){return t||(t=c()),f(e,t)},ldate:function(e,t){return t||(t=c()),d(H,e,t)},locale:function(e){return A(H,e)?H[e]:e},pluralise:function(e,t){return F[e]&&1!==t?F[e]:e},uuid:function(e){return[e||"UUID",++ht,c()].join("_")},htmltable:function(e,t){e=p.merge({},e),t=p.merge({},t||{});var n,r,i,o,l,a,s,c,f,d="",_="",g="",m="",v=[],O=!1;if(d="<table",t.id&&(d+=" id='"+t.id+"'"),t["class"]&&(d+=" class='"+t["class"]+"'"),t.style&&(d+=" style='"+t.style+"'"),t.data)for(n in t.data)p.hasOwn(t.data,n)&&(d+=" data-"+n+"='"+t.data[n]+"'");d+=">",_="",(t.header||t.footer)&&(_="<td>"+(p.keys(e)||[]).join("</td><td>")+"</td>"),g="",t.header&&(g="<thead><tr>"+_+"</tr></thead>"),m="",t.footer&&(m="<tfoot><tr>"+_+"</tr></tfoot>"),d+=g,v=[],l=p.values(e)||[];for(r in l)if(p.hasOwn(l,r))for(a=l[r],u(a)||(a=[a]),s=p.values(a)||[],i=0,o=s.length;o>i;i++)v[i]||(v[i]=new h(o)),v[i][r]=s[i];for(c=t.odd?t.odd:"odd",f=t.even?t.even:"even",O=!1,r=0,o=v.length;o>r;r++)d+=O?"<tr class='"+c+"'><td>"+v[r].join("</td><td>")+"</td></tr>":"<tr class='"+f+"'><td>"+v[r].join("</td><td>")+"</td></tr>",O=!O;return v=null,d+=m,d+="</table>"},htmlselect:function(e,t){e=p.merge({},e),t=p.merge({},t||{});var n,r,o,l,a="";if(a="<select",t.multiple&&(a+=" multiple"),t.disabled&&(a+=" disabled='disabled'"),t.name&&(a+=" name='"+t.name+"'"),t.id&&(a+=" id='"+t.id+"'"),t["class"]&&(a+=" class='"+t["class"]+"'"),t.style&&(a+=" style='"+t.style+"'"),t.data)for(n in t.data)p.hasOwn(t.data,n)&&(a+=" data-"+n+"='"+t.data[n]+"'");a+=">",t.selected?(u(t.selected)||(t.selected=[t.selected]),t.selected=i(t.selected)):t.selected={},t.optgroups&&(u(t.optgroups)||(t.optgroups=[t.optgroups]),t.optgroups=i(t.optgroups));for(n in e)if(p.hasOwn(e,n))if(o=e[n],t.optgroups&&t.optgroups[n]){a+="<optgroup label='"+n+"'>";for(r in o)p.hasOwn(o,r)&&(l=o[r],t.use_key?l=r:t.use_value&&(r=l),a+=p.hasOwn(t.selected,r)?"<option value='"+r+"' selected='selected'>"+l+"</option>":"<option value='"+r+"'>"+l+"</option>");a+="</optgroup>"}else t.use_key?o=n:t.use_value&&(n=o),a+=t.selected[n]?"<option value='"+n+"' selected='selected'>"+o+"</option>":"<option value='"+n+"'>"+o+"</option>";return a+="</select>"},getTemplateContents:Lt,hasOwn:function(e,t){return e&&A(e,t)},keys:function(e){return e?O(e):null},values:function(e){if(e){if(e instanceof h)return e;var t,n=[];for(t in e)A(e,t)&&n.push(e[t]);return n}return null},items:function(e){return e?e:null},merge:kt,data:function(e){if(D(e))return e.slice();var t,n,r={};for(t in e)A(e,t)&&(n=t,r[n]=e[t]);return r}},p.now=p.time,p.l=p.locale,e.constMappingTable={},e.constMappingQuoteStyle={},e.constMappingTable[0]="HTML_SPECIALCHARS",e.constMappingTable[1]="HTML_ENTITIES",e.constMappingQuoteStyle[0]="ENT_NOQUOTES",e.constMappingQuoteStyle[2]="ENT_COMPAT",e.constMappingQuoteStyle[3]="ENT_QUOTES",e.tbls={},p.init(),p});

/**
*
*   Dromeo
*   Simple and Flexible Routing Framework for PHP, Python, Node/JS
*   @version: 0.5
*
*   https://github.com/foo123/Dromeo
*
**/
!function(e,t,n){"use strict";var r,o="object"==typeof module&&module.exports,i="function"==typeof define&&define.amd;o?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||n.call(e,{NODE:module})||1:i&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,r,o){return n.call(e,{AMD:o})}):t in e||(e[t]=r=n.call(e,{})||1)&&i&&define(t,[],function(){return r})}(this,"Dromeo",function(e,t){"use strict";function n(e,t,n){var r=this;r.handlers=[],r.route=e,r.pattern=t,r.captures=n,r.dispose=function(){return r.handlers=null,r.route=null,r.pattern=null,r.captures=null,r}}var r="0.5",o={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",419:"Authentication Timeout",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",440:"Login Timeout",444:"No Response",449:"Retry With",450:"Blocked by Windows Parental Controls",451:"Unavailable For Legal Reasons",494:"Request Header Too Large",495:"Cert Error",496:"No Cert",497:"HTTP to HTTPS",498:"Token expired/invalid",499:"Client Closed Request",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required",520:"Origin Error",521:"Web server is down",522:"Connection timed out",523:"Proxy Declined Request",524:"A timeout occurred",598:"Network read timeout error",599:"Network connect timeout error"},i=/^([a-zA-Z0-9-_]+\|[a-zA-Z0-9-_|]+)$/,l=/\((\d+)\)$/,u=Object.prototype,s=Array.prototype,a=Function.prototype,c=a.call.bind(u.hasOwnProperty),d=a.call.bind(u.toString),h=a.call.bind(s.slice),f="undefined"!=typeof global&&"[object global]"==d(global),p=function(e){return"[object Function]"===d(e)||e instanceof Function},g=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},m=function(e){return e.length>0},_=function(e){return e.replace(/([*+\[\]\(\)?^$\/\\:])/g,"\\$1")},y={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},R=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],b=function(e,t,n){for(var r=y[n||"php"].exec(e),o={},i=14;i--;)r[i]&&(o[R[i]]=r[i]);return"port"in o&&(o.port=parseInt(o.port,10)),t?o[t.replace("PHP_URL_","").toLowerCase()]||null:(o.source&&delete o.source,o)},v=function(e){return decodeURIComponent(""+e)},A=function(e){return encodeURIComponent(""+e).split("!").join("%21").split("'").join("%27").split("(").join("%28").split(")").join("%29").split("*").join("%2A")},P=function(e){return A(e).split("%20").join("+")},q=function(e){var n,r,o,i,l,u,s,a,d,h,f,p,m,_=e.replace(/^&/,"").replace(/&$/,"").split("&"),y=_.length,R={};for(n=0;y>n;n++)if(a=_[n].split("="),d=v(g(a[0])),h=a.length<2?"":v(g(a[1])),r=d.indexOf("\x00"),r>-1&&(d=d.slice(0,r)),d&&"["!==d.charAt(0)){for(p=[],f=0,r=0;r<d.length;r++)if("["!==d.charAt(r)||f){if("]"===d.charAt(r)&&f&&(p.length||p.push(d.slice(0,f-1)),p.push(d.substr(f,r-f)),f=0,"["!==d.charAt(r+1)))break}else f=r+1;for(p.length||(p=[d]),r=0;r<p[0].length&&(s=p[0].charAt(r),(" "===s||"."===s||"["===s)&&(p[0]=p[0].substr(0,r)+"_"+p[0].substr(r+1)),"["!==s);r++);for(u=R,r=0,m=p.length;m>r;r++)if(d=p[r].replace(/^['"]/,"").replace(/['"]$/,""),l=u,""!==d&&" "!==d||0===r)t===u[d]&&(u[d]={}),u=u[d];else{o=-1;for(i in u)c(u,i)&&+i>o&&i.match(/^\d+$/g)&&(o=+i);d=o+1}l[d]=h}return R},N=function(e,t,n,r){var o,i,l=r?A:P;if(!0===t?t="1":!1===t&&(t="0"),null!=t){if("object"==typeof t){i=[];for(o in t)null!=t[o]&&i.push(N(e+"["+o+"]",t[o],n,r));return i.join(n)}return l(e)+"="+l(t)}return""},L=function(e,t,n){var r,o,i,l=[];arguments.length<2&&(t="&"),arguments.length<3&&(n=!1);for(o in e)r=e[o],i=N(o,r,t,n),""!=i&&l.push(i);return l.join(t)},T=function(e,t,n){if(n){var r,o,i=[];for(e=e.split(t),o=0;o<e.length;o++)r=e[o],r=r.split(n),i.push(r[0]),r.length>1&&i.push(r[1]);return i}return e.split(t)},w=function(e,t,n){var r,o,l,u,s,a=0;for(n=T(n,e[3]),u=[],o=n.length,l=!1,r=0;o>r;r++)l?(n[r].length&&(t[n[r]]?(u.push("("+t[n[r]]+")"),a++):(s=n[r].match(i))?(u.push("("+s[1].split("|").filter(m).map(_).join("|")+")"),a++):u.push(_(n[r]))),l=!1):(n[r].length&&u.push(_(n[r])),l=!0);return 1===u.length&&1===a?[u.join(""),a]:["("+u.join("")+")",a+1]},j=function(e,t,r){var o,i,u,s,a,c,d,h,f,p,m,y,R,b,v;for(o=T(r,e[0],e[1]),s=o.length,d=!1,h="",m=0,y={},u=0;s>u;u++)i=o[u],d?(a=!1,c=!1,f=i.split(e[2]),b=w(e,t,f[0]),f.length>1&&(R=g(f[1]),a=R.length&&"?"===R.charAt(0),a&&(R=R.slice(1)),(p=R.match(l))?(R=R.slice(0,-p[0].length),v=parseInt(p[1],10),v>=0&&v<b[1]?v+=m+1:v=m+1):v=m+1,c=R.length>0),h+=b[0],m+=b[1],a&&(h+="?"),c&&(y[R]=v),d=!1):(h+=_(i),d=!0);return new n(r,new RegExp("^"+h+"$"),y)},k=function(e,t,n){delete e[n];var r,o=t.length;for(r=o-1;r>=0;r--)if(n===t[r].route){t.splice(r,1);break}},C=function(e,t,n,r,o,i,l,u){o&&o.length&&i&&"function"==typeof i&&(u=!0===u,l=l||{},o in e?e[o].handlers.push([i,l,u]):(e[o]=j(n,r,o),e[o].handlers.push([i,l,u]),t.push(e[o])))},x=function(){var e=this;e._delims=["{","}",":","%"],e._patterns={},e.definePattern("ALPHA","[a-zA-Z\\-_]+"),e.definePattern("NUMBR","[0-9]+"),e.definePattern("ALNUM","[a-zA-Z0-9\\-_]+"),e.definePattern("QUERY","\\?[^?#]+"),e.definePattern("FRAGM","#[^?#]+"),e.definePattern("ALL",".+"),e._handlers=[],e._routes=[],e._fallback=!1};return x.VERSION=r,x.Route=n,x.prototype={constructor:x,_delims:null,_patterns:null,_handlers:null,_routes:null,_fallback:!1,dispose:function(){var e,t=this;t._delims=null,t._patterns=null,t._routes=null,t._fallback=null;for(e in t._handlers)t._handlers[e].dispose();return t._handlers=null,t},reset:function(){return this._handlers={},this._routes=[],this._fallback=!1,this},defineDelimiters:function(e){var t,n=this;return e&&(t=e.length,t>0&&e[0]&&(n._delims[0]=e[0]),t>1&&e[1]&&(n._delims[1]=e[1]),t>2&&e[2]&&(n._delims[2]=e[2]),t>3&&e[3]&&(n._delims[3]=e[3])),n},definePattern:function(e,t){return this._patterns[e]=t,this},dropPattern:function(e){return e in this._patterns&&delete this._patterns[e],this},parse:function(e,t,n){var r={};return e&&(arguments.length<3&&(n="fragment_params"),arguments.length<2&&(t="query_params"),r=b(e),t&&(r[t]=r.query?this.unglue(r.query):{}),n&&(r[n]=r.fragment?this.unglue(r.fragment):{})),r},unglue:function(e){var t;return t=e?q(e):{}},build:function(e,t,n,r,o){var i=""+e;return arguments.length<5&&(o="#"),arguments.length<4&&(r="?"),t&&(i+=r+this.glue(t)),n&&(i+=o+this.glue(n)),i},glue:function(e){var t="";return e&&(t+=L(e,"&",!0)),t},redirect:function(e,t,n,r){return e&&(f?t&&(arguments.length<3&&(n=302),arguments.length<4&&(r=!0),r?(!0===r&&(r=o[n]||""),t.writeHead(n,r,{Location:e})):t.writeHead(n,{Location:e}),t.end()):document.location.href=e),this},on:function(){var e,t,n,r=this,o=h(arguments),i=o.length;if(i>=2)e=o,n=e[2]||null,C(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n);else if(1===i&&o[0]instanceof Array)for(o=o[0],i=o.length,t=0;i>t;t++)e=o[t],e.length>=2&&(n=e[2]||null,C(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n));return r},one:function(){var e,t,n,r=this,o=h(arguments),i=o.length;if(i>=2)e=o,n=e[2]||null,C(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n,!0);else if(1===i&&o[0]instanceof Array)for(o=o[0],i=o.length,t=0;i>t;t++)e=o[t],e.length>=2&&(n=e[2]||null,C(r._handlers,r._routes,r._delims,r._patterns,e[0],e[1],n,!0));return r},off:function(e,t){var n,r,o,i=this,l=i._routes,u=i._handlers;if(e&&e in u)if(t&&p(t)){for(r=u[e],o=r.handlers.length,n=o-1;n>=0;n--)t===r.handlers[n][0]&&r.handlers.splice(n,1);r.handlers.length||k(u,l,e)}else k(u,l,e);return i},fallback:function(e){return 1>arguments.length&&(e=!1),(!1===e||null===e||p(e))&&(this._fallback=e),this},route:function(e){var t,n,r,o,i,l,u,s,a,c,d,h,f=this,p=f._routes;if(e)for(o=p.length,r=0;o>r;r++)if(t=p[r],u=e.match(t.pattern)){for(c=t.handlers.slice(0),h=[],i=c.length,l=0;i>l;l++)c[l][2]&&h.push(l);for(i=h.length;--i>=0;)t.handlers.splice(h.pop(),1);for(i=c.length,l=0;i>l;l++){d=c[l],n={};for(s in t.captures)a=t.captures[s],n[s]=u[a]?u[a]:s in d[1]?d[1][s]:null;d[0](e,n)}return!0}return f._fallback?(f._fallback(e,!1),!1):!1}},x});

/**
*
*   ModelView.js
*   @version: 0.42
*
*   A micro-MV* (MVVM) framework for complex (UI) screens 
*   optionaly integrates into both jQuery as MVVM plugin and jQueryUI as MVC widget
*   https://github.com/foo123/modelview.js
*
**/!function(e,t,n){"use strict";var i,r="object"==typeof module&&module.exports,l="function"==typeof define&&define.amd;r?module.exports=(module.$deps=module.$deps||{})[t]=module.$deps[t]||n.call(e,{NODE:module})||1:l&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["require","exports","module"],function(t,i,r){return n.call(e,{AMD:r})}):t in e||(e[t]=i=n.call(e,{})||1)&&l&&define(t,[],function(){return i})}(this,"ModelView",function(e){"use strict";function t(e,t){var n=[e||"",jt];return t&&(n=n.concat(t)),n.join(".")}function n(e){return-1<Ht.indexOf(e)}function r(e,t){return e.toLowerCase()===t.tagName.toLowerCase()}function l(e,t){return e===t.id}function o(e,t){return this.$element===window?t===document:this.$element===t}function a(e){var t=this;return t instanceof a?(e&&t.element(e),void(t.$handle=a.Handler.bind(t))):new a(e)}var u=void 0,s=function(e,t){return e.bind(t)},c="prototype",f=Array,d=f[c],h=RegExp,v=Number,m=Object,p=m[c],g=m.create,$=m.keys,b=Function,y=b[c],k=String,w=k[c],E=y.call,_=(s(E,p.hasOwnProperty),s(E,p.toString)),S=s(E,d.slice),C=function(e,t){return new b(e,t)},O=function(e,t){return e instanceof t},x=function(e){return k(e)},R=1/0,V=(Math.random,function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}),L=function(e,t,n){return e[t]=u,n||delete e[t],e},D=2,N=3,M=4,A=8,j=9,P=16,I=32,z=64,H=128,F=256,B=512,U=1024,q=P|I,W=P|A,X=function(e){var t,n;return null===e?F:!0===e||!1===e?M:(t=typeof e,n=_(e),u===e||"undefined"===t?B:e instanceof v||"number"===t?isNaN(e)?N:D:e instanceof k||"string"===t?1===e.length?j:A:e instanceof f||"[object Array]"===n?P:e instanceof h||"[object RegExp]"===n?H:e instanceof b||"function"===t&&"[object Function]"===n?z:"[object Object]"===n?I:U)},J=function(e,t){return!!(t&X(e))},Q=function(e){return!isNaN(parseFloat(e,10))&&isFinite(e)},Y=function(e){return Q(e)&&(e=+e,0===e%1&&e>=0)?!0:!1},Z=function(){var e,t,n,i,r,l,o,a=arguments;for(t=a[0]||{},e=a.length,l=1;e>l;l++)if(n=a[l],I===X(n))for(r in n)i=n[r],o=X(i),t[r]=D&o?0+i:W&o?i.slice(0):i;return t},G="getAttribute",K="setAttribute",et="checked",tt="disabled",nt="selected",it="name",rt="tagName",lt="type",ot="value",at="options",ut="selectedIndex",st="parentNode",ct="style",ft="innerHTML",dt="innerText",ht="textContent",vt=function(e,t){return d.slice.call((t||document).getElementsByTagName(e),0)},mt=function(e,t,n){return!0===n?[(t||document).querySelector(e)]:d.slice.call((t||document).querySelectorAll(e),0)},pt=function(e){return e?e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector:void 0}(this.Element?this.Element[c]:null),gt=function(e){return document.createTextNode(e||"")},$t=window.getComputedStyle?function(e){return window.getComputedStyle(e,null)}:function(e){return e.currentStyle},bt=function(e){e._displayCached||(e._displayCached=$t(e).display||"block"),e[ct].display="none"!==e._displayCached?e._displayCached:"block",e._displayCached=u},yt=function(e){e._displayCached||(e._displayCached=$t(e).display||"block"),e[ct].display="none"},kt=function(e){var t=e.attributes[ot];return!t||t.specified?e[ot]:e.text},wt=function(e){for(var t,n,i=e[at],r=e[ut],l="select-one"===e[lt]||0>r,o=l?null:[],a=l?r+1:i.length,u=0>r?a:l?r:0;a>u;u++)if(n=i[u],!(!n[nt]&&u!==r||n[tt]||n[st][tt]&&"optgroup"===n[st][rt])){if(t=kt(n),l)return t;o.push(t)}return o},Et=function(e,t){var n,i,r=[].concat(t).map(x),l=e[at];for(i=0;i<l.length;i++)n=l[i],n[nt]=-1<r.indexOf(kt(n));r.length||(e[ut]=-1)},_t=function(e){if(e)switch(e[rt].toLowerCase()){case"textarea":case"input":return e[ot];case"select":return wt(e);default:return ht in e?e[ht]:e[dt]}},Tt=function(e,t){if(e)switch(e[rt].toLowerCase()){case"textarea":case"input":e[ot]=k(t);break;case"select":Et(e,t);break;default:ht in e?e[ht]=k(t):e[dt]=k(t)}},St=function(e){return e.length>0},Ct=/\s+/g,Ot=function(e){var t=e.split("."),n=t[0];return t=t.slice(1).filter(St),[n,t.sort()]},xt=function(e){return e.length?new h("(^|\\.)"+e.join("\\.(?:.*\\.|)")+"(\\.|$)"):!1},Rt=JSON.parse,Vt=JSON.stringify,Lt=w.trim?function(e){return e.trim()}:function(e){return e.replace(/^\s+|\s+$/g,"")},Dt=w.startsWith?function(e,t,n){return e.startsWith(t,n)}:function(e,t,n){return n=n||0,t===e.substr(n,t.length+n)},Nt=Date.now?Date.now:function(){return(new Date).getTime()},Mt=function(e,t){this.v=e||null,this.n=t||{}},At="*",jt="modelview",Pt=0,It=function(e){return[e||"UUID",++Pt,Nt()].join("_")};this.Element&&this.Element[c].attachEvent&&!this.Element[c].addEventListener&&!function(){function e(e,t){Window[c][e]=HTMLDocument[c][e]=Element[c][e]=t}e("addEventListener",function(e,t){var n=this,i=n.addEventListener.listeners=n.addEventListener.listeners||{},r=i[e]=i[e]||[];r.length||n.attachEvent("on"+e,r.event=function(e){var t=n.document&&n.document.documentElement||n.documentElement||{scrollLeft:0,scrollTop:0};e.currentTarget=n,e.pageX=e.clientX+t.scrollLeft,e.pageY=e.clientY+t.scrollTop,e.preventDefault=function(){e.returnValue=!1},e.relatedTarget=e.fromElement||null,e.stopImmediatePropagation=function(){a=!1,e.cancelBubble=!0},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||n,e.timeStamp=+new Date;for(var i,l=0,o=[].concat(r),a=!0;a&&(i=o[l]);++l)for(var u,s=0;u=r[s];++s)if(u==i){u.call(n,e);break}}),r.push(t)}),e("removeEventListener",function(e,t){for(var n,i=this,r=i.addEventListener.listeners=i.addEventListener.listeners||{},l=r[e]=r[e]||[],o=l.length-1;n=l[o];--o)if(n==t){l.splice(o,1);break}!l.length&&l.event&&i.detachEvent("on"+e,l.event)}),e("dispatchEvent",function(e){var t=this,n=e.type,i=t.addEventListener.listeners=t.addEventListener.listeners||{},r=i[n]=i[n]||[];try{return t.fireEvent("on"+n,e)}catch(l){return void(r.event&&r.event(e))}})}();var zt="DOMEVENT_STOPPED",Ht=["blur","error","focus","load","resize","scroll"];a.Handler=function(e){if(!e[zt]){var t,n,i,r,l,o,a,u=this,s=e.type,c=e.target,f=[];switch(c&&3===c.nodeType&&(c=c.parentNode),r=u.$element,i=r.$listeners,l=e.eventPhase||(e.target!==e.currentTarget?3:2)){case 1:f=i[1][s];break;case 2:i[0]&&i[0][s]&&(f=f.concat(i[0][s])),i[1]&&i[1][s]&&(f=f.concat(i[1][s]));break;case 3:f=i[0][s]}for(n=f.length;n&&c;){for(t=0;n>t&&(o=f[t],o);t++)if(o.matcher.call(c,o.matcherParam,c)&&(a=o.handler.call(c,e,c)),!1===a||!1===e.returnValue)return e[zt]=!0,void e.preventDefault();if(r===c)break;n=f.length,c=c.parentElement}}},a[c]={constructor:a,$element:null,$handle:null,dispose:function(){var e=this;return e.off().element(),e.$element=null,e.$handle=null,e},element:function(e){var t,n,i,r=this,l=r.$element;if(l){for(t=l.$listeners,n=$(t[1]),i=0;i<n.length;i++)l.removeEventListener(n[i],r.$handle,!0);for(n=$(t[0]),i=0;i<n.length;i++)l.removeEventListener(n[i],r.$handle,!1);l.$listeners=u}return e&&e.addEventListener?(r.$element=e,e.$listeners=e.$listeners||[{},{}],r):(r.$element=null,r)},on:function(e,t,i,a){var s,c,f,d,h,v,m,p,g=this;if(!e)throw new TypeError("Invalid event type: "+e);if(m=e.split(Ct).map(Ot),!m.length)return g;if("function"==typeof t&&(a=i,i=t,t=null),"function"!=typeof i)throw new TypeError("Handler must be a type of Function");for(s=g.$element,d=0,h=m.length;h>d;d++)p=u===a?n(m[d][0]):!!a,c=s.$listeners[p?1:0],c[m[d][0]]||(c[m[d][0]]=[],s.addEventListener(m[d][0],g.$handle,p)),t?/^[a-z]+$/i.test(t)?(v=t,f=r):/^#[a-z0-9\-_]+$/i.test(t)?(v=t.slice(1),f=l):(v=t,f=pt):(v=null,f=o.bind(g)),c[m[d][0]].push({selector:t,handler:i,matcher:f,matcherParam:v,namespace:m[d][1].join(".")});return g},off:function(e,t,n,i){var r,l,o,a,s,c,f,d,h,v,m=this,p=m.$element,g=!1;if("function"==typeof t&&(i=n,n=t,t=null),g=u===i?[0,1]:i?[1]:[0],v=e?e.split(/\s+/g).map(Ot):[],v.length){for(c=0;c<g.length;c++)for(o=p.$listeners[g[c]],s=0;s<v.length;s++)if(d=v[s][1],f=v[s][0],h=xt(d),f.length){if(a=o[f],!a||!a.length)continue;for(r=a.length-1;r>=0;r--)l=a[r],t&&t!==l.selector||n&&n!==l.handler||h&&!h.test(l.namespace)||a.splice(r,1);a.length||(delete o[f],p.$element.removeEventListener(f,m.$handle,!!g[c]))}else for(f in o)if(a=o[f],a&&a.length){for(r=a.length-1;r>=0;r--)l=a[r],t&&t!==l.selector||n&&n!==l.handler||h&&!h.test(l.namespace)||a.splice(r,1);a.length||(delete o[f],p.$element.removeEventListener(f,m.$handle,!!g[c]))}}else for(c=0;c<g.length;c++){o=p.$listeners[g[c]];for(f in o)if(a=o[f],a&&a.length){for(r=a.length-1;r>=0;r--)l=a[r],t&&t!==l.selector||n&&n!==l.handler||a.splice(r,1);a.length||(delete o[f],p.removeEventListener(f,m.$handle,!!g[c]))}}return m}};var Ft=2,Bt=function(e,t,n){var i=this;return i instanceof Bt?(i.type=e,i.target=t,i.currentTarget=t,i.timeStamp=Nt(),i.eventPhase=Ft,void(i.namespace=n||null)):new Bt(e,t,n)};Bt[c]={constructor:Bt,type:null,target:null,currentTarget:null,timeStamp:null,eventPhase:Ft,bubbles:!1,cancelable:!1,namespace:null,stopPropagation:function(){this.bubbles=!1},preventDefault:function(){}};var Ut={$PB:null,namespace:null,initPubSub:function(){var e=this;return e.$PB={},e},disposePubSub:function(){var e=this;return e.$PB=null,e},trigger:function(e,t){var n,i,r,l,o,a=this,u=a.$PB;if(o=Ot(e),e=o[0],(n=u[e])&&(l=n.length)){for(i=n.slice(0),o=o[1].join("."),e=new Bt(e,a,o),r=0;l>r&&(i[r][3]=1,!1!==i[r][0](e,t));r++);if((n=u[e])&&(l=n.length))if(n.oneOffs>0)for(r=l-1;r>=0;r--)i=n[r],i[2]&&i[3]&&(n.splice(r,1),n.oneOffs=n.oneOffs>0?n.oneOffs-1:0);else n.oneOffs=0}return a},on:function(e,t,n){var i,r,l,o,a=this,u=a.$PB;if(e&&e.length&&J(t,z)){if(n=!!n,r=e.split(Ct).map(Ot),!(o=r.length))return a;for(l=0;o>l;l++)e=r[l][0],i=r[l][1].join("."),u[e]||(u[e]=[],u[e].oneOffs=0),u[e].push([t,i,n,0]),n&&u[e].oneOffs++}return a},onTo:function(e,t,n,i){var r=this;return J(n,z)&&(n=s(n,r)),e.on(t,n,i),r},off:function(e,t){var n,i,r,l,o,a,u,s,c,f,d=this,h=d.$PB;if(e&&e.length){for(u=J(t,z),s=e.split(Ct).map(Ot),c=0,f=s.length;f>c;c++)if(e=s[c][0],a=xt(s[c][1]),e.length){if((n=h[e])&&(l=n.length))for(r=l-1;r>=0;r--)o=n[r],u&&t!==o[0]||a&&!a.test(o[1])||(o[2]&&(n.oneOffs=n.oneOffs>0?n.oneOffs-1:0),n.splice(r,1))}else if(u||a)for(i in h)if(n=h[i],n&&(l=n.length))for(r=l-1;r>=0;r--)o=n[r],u&&t!==o[0]||a&&!a.test(o[1])||(o[2]&&(n.oneOffs=n.oneOffs>0?n.oneOffs-1:0),n.splice(r,1))}else for(i in h)delete h[i];return d},offFrom:function(e,t,n){var i=this;return e.off(t,n),i}};Ut.publish=Ut.trigger;var qt=function(e,t){var n=this,i=arguments.length;n.$store={},n.$size=R,n.$interval=R,i>0&&e>0&&(n.$size=e),i>1&&t>0&&(n.$interval=t)};qt[c]={constructor:qt,$store:null,$size:null,$interval:null,dispose:function(){var e=this;return e.$store=null,e.$size=null,e.$interval=null,e},reset:function(){return this.$store={},this},size:function(e){return arguments.length?(e>0&&(this.$size=e),this):this.$size},interval:function(e){return arguments.length?(e>0&&(this.$interval=e),this):this.$interval},has:function(e){var t=this,n=e?t.$store[e]:null;return!!(n&&Nt()-n.time<=t.$interval)},get:function(e){if(e){var t=this,n=t.$store[e];if(n)return Nt()-n.time>t.$interval?(delete t.$store[e],u):n.data}return u},set:function(e,t){var n,i,r,l=this;if(e){for(n=l.$store,i=l.$size,r=$(n);r.length>=i;)delete n[r.shift()];n[e]={data:t,time:Nt()}}return l},del:function(e){return e&&this.$store[e]&&delete this.$store[e],this},toString:function(){return"[ModelView.Cache]"}};var Wt=function(e){return O(this,Wt)?void(this.f=e||null):new Wt(e)},Xt=function(e){return O(this,Xt)?void(this.f=e||null):new Xt(e)},Jt=function(e,t){var n,i;for(n in t)i=t[n],O(i,Xt)?(t[n]=s(i.f,e),t[n].fEach=!0):t[n]=s(i,e);return t},Qt=function(e){return e.BEFORE=function(t){return Qt(function(n,i){var r=this;return t.call(r,e.call(r,n,i),i)})},e.AFTER=function(t){return Qt(function(n,i){var r=this;return e.call(r,t.call(r,n,i),i)})},e},Yt=function(e){return e.NOT=function(){return Yt(function(t,n){return!e.call(this,t,n)})},e.AND=function(t){return Yt(function(n,i){var r=this;return e.call(r,n,i)&&t.call(r,n,i)})},e.OR=function(t){return Yt(function(n,i){var r=this;return e.call(r,n,i)||t.call(r,n,i)})},e.XOR=function(t){return Yt(function(n,i){var r=this,l=e.call(r,n,i),o=t.call(r,n,i);return l&&!o||o&&!l})},e},Zt={TypeCaster:Qt,Cast:{EACH:Xt,FIELDS:function(e){var t=!0;return e=Z({},e||{}),Qt(function(n){var i,r,l,o,a;t&&(Jt(this,e),t=!1);for(i in e)if(r=e[i],l=n[i],r.fEach&&J(l,P)){for(o=l.length,a=0;o>a;a++)l[a]=r(l[a]);n[i]=l}else n[i]=r(l);return n})},DEFAULT:function(e){return Qt(function(t){var n=X(t);return(B&n||A&n&&!Lt(t).length)&&(t=e),t})},BOOL:Qt(function(e){return!!e}),INT:Qt(function(e){return parseInt(e,10)}),FLOAT:Qt(function(e){return parseFloat(e,10)}),MIN:function(e){return Qt(function(t){return e>t?e:t})},MAX:function(e){return Qt(function(t){return t>e?e:t})},CLAMP:function(e,t){if(e>t){var n=t;t=e,e=n}return Qt(function(n){return e>n?e:n>t?t:n})},TRIM:Qt(function(e){return Lt(k(e))}),LCASE:Qt(function(e){return k(e).toLowerCase()}),UCASE:Qt(function(e){return k(e).toUpperCase()}),STR:Qt(function(e){return""+e})},add:function(e,t){return J(e,A)&&J(t,z)&&(Zt.Cast[e]=Qt(t)),Zt},del:function(e){return J(e,A)&&Zt.Cast[e]&&delete Zt.Cast[e],Zt},toString:function(){return"[ModelView.Type]"}},Gt={Validator:Yt,Validate:{EACH:Xt,FIELDS:function(e){var t=!0;return e=Z({},e||{}),Yt(function(n){var i,r,l,o,a;t&&(Jt(this,e),t=!1);for(i in e)if(r=e[i],l=n[i],r.fEach&&J(l,P)){for(o=l.length,a=0;o>a;a++)if(!r(l[a]))return!1}else if(!r(l))return!1;return!0})},NUMERIC:Yt(function(e){return Q(e)}),NOT_EMPTY:Yt(function(e){return!!(e&&0<Lt(k(e)).length)}),MAXLEN:function(e){return Yt(C("v","return v.length <= "+e+";"))},MINLEN:function(e){return Yt(C("v","return v.length >= "+e+";"))},MATCH:function(e){return Yt(function(t){return e.test(t)})},NOT_MATCH:function(e){return Yt(function(t){return!e.test(t)})},EQUAL:function(e,t){return Yt(O(e,Wt)?C("v","return this.$data."+e.f+" "+(!1!==t?"===":"==")+" v;"):!1!==t?function(t){return e===t}:function(t){return e==t})},NOT_EQUAL:function(e,t){return Yt(O(e,Wt)?C("v","return this.$data."+e.f+" "+(!1!==t?"!==":"!=")+" v;"):!1!==t?function(t){return e!==t}:function(t){return e!=t})},GREATER_THAN:function(e,t){return O(e,Wt)?e="this.$data."+e.f:J(e,A)&&(e='"'+e+'"'),Yt(C("v","return "+e+" "+(!1!==t?"<":"<=")+" v;"))},LESS_THAN:function(e,t){return O(e,Wt)?e="this.$data."+e.f:J(e,A)&&(e='"'+e+'"'),Yt(C("v","return "+e+" "+(!1!==t?">":">=")+" v;"))},BETWEEN:function(e,t,n){J(e,P)&&(n=t,t=e[1],e=e[0]);var i,r=O(e,Wt),l=O(t,Wt);return!r&&!l&&e>t&&(i=t,t=e,e=i),e=r?"this.$data."+e.f:J(e,A)?'"'+e+'"':e,t=l?"this.$data."+t.f:J(t,A)?'"'+t+'"':t,Yt(!1!==n?C("v","return ( "+e+" < v ) && ( "+t+" > v );"):C("v","return ( "+e+" <= v ) && ( "+t+" >= v );"))},NOT_BETWEEN:function(e,t,n){J(e,P)&&(n=t,t=e[1],e=e[0]);var i,r=O(e,Wt),l=O(t,Wt);return!r&&!l&&e>t&&(i=t,t=e,e=i),e=r?"this.$data."+e.f:J(e,A)?'"'+e+'"':e,t=l?"this.$data."+t.f:J(t,A)?'"'+t+'"':t,Yt(!1!==n?C("v","return ( "+e+" > v ) || ( "+t+" < v );"):C("v","return ( "+e+" >= v ) || ( "+t+" <= v );"))},IN:function(){var e=S(arguments);return J(e[0],P)&&(e=e[0]),Yt(function(t){return-1<e.indexOf(t)})},NOT_IN:function(){var e=S(arguments);return J(e[0],P)&&(e=e[0]),Yt(function(t){return 0>e.indexOf(t)})}},add:function(e,t){return J(e,A)&&J(t,z)&&(Gt.Validate[e]=Yt(t)),Gt},del:function(e){return J(e,A)&&Gt.Validate[e]&&delete Gt.Validate[e],Gt},toString:function(){return"[ModelView.Validation]"}},Kt=function(e,t){if(!e)return null;var n,i,r=[],l=e.length;for(n=0;l>n;n++)i=e[n],i&&(i[t]&&r.push(i[t].n),i[At]&&r.push(i[At].n));return r.length?r:null},en=function(e,t){if(!e)return null;var n,i,r=e.length;if(t){for(n=0;r>n;n++)if(i=e[n]){if(i[t]&&i[t].v)return i[t].v;if(i[At]&&i[At].v)return i[At].v}}else for(n=0;r>n;n++)if(i=e[n],i&&i.v)return i.v;return null},tn=function(e,t,n,i){for(var r,l=n,o=0,a=t.length;a>o;)r=t[o++],r in l||(l[r]=new Mt),l=l[r],a>o?l=l.n:i?(At in l.n||(l.n[At]=new Mt),l.n[At].v=e):l.v=e;return n},nn=function(e,t,n,i){for(var r,l,o=t,a=n?[n]:null,u=0,s=e.length;s>u;){if(r=e[u++],l=X(o),!(s>u))return a&&en(a,r)?!0:l&q&&r in o?!0:I===l&&"length"==r?!0:!1;if(l&q&&r in o){if(o=o[r],o instanceof i)return[i,o,e.slice(u)];a&&(a=Kt(a,r))}else if(!a||!(a=Kt(a,r)))return!1}return!1},rn=function(e,t,n,i){for(var r,l,o=t,a=n?[n]:null,u=0,s=e.length;s>u;){if(r=e[u++],l=X(o),!(s>u))return a&&(a=en(a,r))?[!1,a]:l&q&&r in o?[!0,o[r]]:I===l&&"length"==r?[!0,$(o).length]:!1;if(l&q&&r in o){if(o=o[r],o instanceof i)return[i,o,e.slice(u)];a&&(a=Kt(a,r))}else if(!a||!(a=Kt(a,r)))return!1}return!1},ln=function(e,t,n,i,r,l,o){var a,u,s=t,c=null,f=null,d=null,h=0,v=e.length;for(o=!1!==o,o&&(c=[n],f=[i],d=[r]);v>h;)if(a=e[h++],u=X(s),v>h){if(!(u&q&&a in s))return[!1,s,a,e,null,null,null];if(s=s[a],s instanceof l)return[l,s,e.slice(h),0,null,null,null];o&&(c=Kt(c,a),f=Kt(f,a),d=Kt(d,a))}else if(u&q)return s[a]instanceof l?[l,s[a],e.slice(h),0,null,null,null]:a in s?[!0,s,a,e.slice(h),c,f,d]:[!1,s,a,e.slice(h),c,f,d];return[!1,s,a,e.slice(h),null,null,null]},on=function(e){return e.replace(/\[([^\]]*)\]/g,".$1").replace(/^\.+/,"").replace(/\.+$/,"")},an=function(e){return"["+e.split(".").join("][")+"]"},un=function(e){var t=new h("^"+e+"([\\.|\\[])");return function(e,n){var i=e.replace(t,"$1");return n?on(i):i}},sn=function(e,t,n,i){var r,l,o=!1;if(l=X(n),z&l)o=O(n,Xt),n=o?s(n.f,e):s(n,e),tn(n,-1<t.indexOf(".")?t.split("."):[t],i,o);else if(q&l)for(r in n)sn(e,t+"."+r,n[r],i)},cn=function(e,t,n,i){var r,l;if(l=X(n),z&l)tn(s(n,e),-1<t.indexOf(".")?t.split("."):[t],i);else if(q&l)for(r in n)cn(e,t+"."+r,n[r],i)},fn=function(e,t,n){for(var i,r;t instanceof e;)t=t.data();if(r=n||X(t),t=I&r?Z({},t):P&r?t.slice(0):t,q&r)for(i in t)t[i]instanceof e?t[i]=fn(e,Z({},t[i].data())):q&(r=X(t[i]))&&(t[i]=fn(e,t[i],r));return t},dn=function(e,t){var n,r=this,l=r.$syncTo,o=t.key,a=t.value;if(o&&o in l)for(n=l[o],i=0;i<n.length;i++)n[i][0].set(n[i][1],a,1)},hn=function(e,t,n,i,r,l){var o=this;return o instanceof hn?(o.namespace=o.id=e||It("Model"),o.key=un(o.id),o.$view=null,o.atomic=!1,o.$atom=null,o.$types={},o.$validators={},o.$getters={},o.$setters={},o.$syncTo={},void o.data(t||{}).types(n).validators(i).getters(r).setters(l).initPubSub()):new hn(e,t,n,i,r,l)};hn.count=function(e){if(!arguments.length)return 0;var t=X(e);return I===t?$(e).length:P===t?e.length:B!==t?1:0},hn[c]=Z(g(m[c]),Ut,{constructor:hn,id:null,$view:null,$data:null,$types:null,$validators:null,$getters:null,$setters:null,atomic:!1,$atom:null,$syncTo:null,$syncHandler:null,dispose:function(){var e=this;return e.disposePubSub().$view=null,e.$data=null,e.$types=null,e.$validators=null,e.$getters=null,e.$setters=null,e.atomic=!1,e.$atom=null,e.key=null,e.$syncTo=null,e.$syncHandler=null,e},isValid:function(){return!0},view:function(e){var t=this;return arguments.length?(t.$view=e,t):t.$view},data:function(e){var t=this;return arguments.length?(t.$data=e,t):t.$data},types:function(e){var t,n=this;if(J(e,I))for(t in e)sn(n,t,e[t],n.$types);return n},validators:function(e){var t,n=this;if(J(e,I))for(t in e)sn(n,t,e[t],n.$validators);return n},getters:function(e){var t,n=this;if(J(e,I))for(t in e)cn(n,t,e[t],n.$getters);return n},setters:function(e){var t,n=this;if(J(e,I))for(t in e)cn(n,t,e[t],n.$setters);return n},serialize:function(){return fn(hn,this.$data)},toJSON:function(e){var t,n,i,r=this;n=arguments.length?r.get(e):r.data();try{t=Vt(fn(hn,n))}catch(i){throw i}return t},fromJSON:function(e,t){var n,i,r=this;if(e){try{n=Rt(e)}catch(i){throw i}t?r.set(t,n):r.data(n)}return r},has:function(e,t){var n,i=this;return 0>e.indexOf(".")&&(e in i.$data||!t&&(n=i.$getters[e])&&n.v)?!0:(n=nn(e.split("."),i.$data,t?null:i.$getters,hn))?!0===n?!0:n[1].has(n[2].join(".")):!1},get:function(e,t){var n,i=this;return 0>e.indexOf(".")?!t&&(n=i.$getters[e])&&n.v?n.v(e):i.$data[e]:(n=rn(e.split("."),i.$data,t?null:i.$getters,hn))?hn===n[0]?n[1].get(n[2].join("."),t):!1===n[0]?n[1](e):n[1]:u},set:function(e,t,n,i){var r,l,o,a,u,s,c,f,d,h,v=this,m=!1;if(v.atomic&&Dt(e,v.$atom))return v;if(l=v.$data,c=v.$types,f=v.$validators,d=v.$setters,0>e.indexOf("."))o=e,s=(r=d[o])?r.v:null,a=(r=c[o]||c[At])?r.v:null,u=(r=f[o]||f[At])?r.v:null,m=!0;else if(r=ln(e.split("."),l,c,f,d,hn)){if(l=r[1],o=r[2],a=en(r[4],o),u=en(r[5],o),s=en(r[6],o),hn===r[0])return o.length?(o=o.join("."),h=l.get(o),h!==t?l.set(o,t,n,i):n=!1):(h=l.data(),h!==t?l.data(t):n=!1),n&&v.publish("change",{key:e,value:t,valuePrev:h,$callData:i}),v;if(!s&&!1===r[0]&&r[3].length)return v;m=!0}if(m){if(a&&(t=a(t,e)),u&&!u(t,e))return n&&(i&&(i.error=!0),v.publish("error",{key:e,value:l[o],$callData:i})),v;if(s)return s(e,t)&&(n&&v.publish("change",{key:e,value:t,$callData:i}),v.$atom&&e===v.$atom&&(v.atomic=!0)),v;h=l[o],h!==t&&(l[o]=t,n&&v.publish("change",{key:e,value:t,valuePrev:h,$callData:i}),v.$atom&&e===v.$atom&&(v.atomic=!0))}return v},add:function(e,t,n,i){var r,l,o,a,s,c,f=this,d=!1;if(f.atomic&&Dt(e,f.$atom))return f;if(l=f.$data,types=f.$types,validators=f.$validators,setters=f.$setters,0>e.indexOf("."))o=e,c=(r=setters[o])&&r.n[At]?r.n[At].v:null,a=(r=types[o]||types[At])&&r.n[At]?r.n[At].v:null,s=(r=validators[o]||validators[At])&&r.n[At]?r.n[At].v:null,d=!0;else if(r=ln(e.split("."),l,types,validators,setters,hn)){if(l=r[1],o=r[2],a=en(Kt(r[4],o),At),s=en(Kt(r[5],o),At),c=en(Kt(r[6],o),At),hn===r[0])return o.length?(o=o.join("."),l.append(o,t,n,i)):l.data(t),n&&f.publish("change",{key:e,value:t,$callData:i}),f;if(!c&&!1===r[0]&&r[3].length)return f;d=!0}if(d){if(a&&(t=a(t,e)),s&&!s(t,e))return n&&(i&&(i.error=!0),f.publish("error",{key:e,value:u,$callData:i})),f;if(c)return c(e,t)&&(n&&f.publish("change",{key:e,value:t,$callData:i}),f.$atom&&e===f.$atom&&(f.atomic=!0)),f;P===X(l[o])?l[o].push(t):l[o]=t,n&&f.publish("change",{key:e,value:t,$callData:i}),f.$atom&&e===f.$atom&&(f.atomic=!0)}return f},del:function(e,t,n,i){var r,l,o,a,s=this,c=!1;if(s.atomic&&Dt(e,s.$atom))return s;if(t=!!t,l=s.$data,0>e.indexOf("."))o=e,c=!0;else if(r=ln(e.split("."),l,null,null,null,hn,!1)){if(l=r[1],o=r[2],hn===r[0]&&o.length)return o=o.join("."),a=l.get(o),l.del(o,t,n,i),n&&s.publish("delete",{key:e,value:a,$callData:i}),s.$atom&&e===s.$atom&&(s.atomic=!0),s;if(r[3].length)return s;c=!0}return c&&(a=l[o],t?(l[o]=u,T=X(l),P==T&&Y(o)?l.splice(+o,1):I==T&&delete l[o]):delete l[o],n&&s.publish("delete",{key:e,value:a,$callData:i}),s.$atom&&e===s.$atom&&(s.atomic=!0)),s},sync:function(e,t){var n,i=this;for(n in t)i.$syncTo[n]=i.$syncTo[n]||[],i.$syncTo[n].push([e,t[n]]);return i.$syncHandler||i.on("change",i.$syncHandler=dn.bind(i)),i},unsync:function(e){var t,n,i,r=this,l=r.$syncTo;for(t in l)if(n=l[t],n.length)for(i=n.length-1;i>=0;i--)e===n[i][0]&&n.splice(i,1);return r},notify:function(e,t,n){return e&&this.publish(t||"change",{key:e,$callData:n}),this},atom:function(e){var t=this;return u!==e&&(!1===e?(t.atomic=!1,t.$atom=null):(t.atomic=!1,t.$atom=e)),t},toString:function(){return"[ModelView.Model id: "+this.id+"]"}}),hn[c].append=hn[c].add,hn[c].rem=hn[c].del;var vn=function(e,t){return new h(V(e).replace("__MODEL__",V(t||"")).replace("__KEY__","(\\S+?)"),"")},mn=function(e){var t,n=e.length,i=n?e[0].nodeValue:"";if(n>1)for(t=1;n>t;t++)i+=e[t].nodeValue;return i},pn="mv_namedkey",gn="mv_uuid",$n=0,bn=function(e){return e[gn]=e[gn]||e.id||(++$n).toString(16)},yn=function(e,t){var n;return t&&(n=e[gn])&&t[n]&&L(t,n),t},kn=function(e,t,n,i){if(!t)return n;var r,l,o,a,u,s,c,f,d,h,v,m,p,g,$,b,y,k;if(n=n||{},e){if(r=[],l=[],c=e,c.attributes&&(a=c.attributes.length))for(o=0;a>o;o++)f=c.attributes[o],(u=f.nodeValue.match(t))&&l.push([f,u,c]);if(3===c.nodeType)(u=c.nodeValue.match(t))&&r.push([c,u,c[st]]);else if(c.firstChild)for(b=[c=c.firstChild];b.length;){if(c.attributes&&(a=c.attributes.length))for(o=0;a>o;o++)f=c.attributes[o],(u=f.nodeValue.match(t))&&l.push([f,u,c]);if(c.firstChild)b.push(c=c.firstChild);else{for(3===c.nodeType&&(u=c.nodeValue.match(t))&&r.push([c,u,c[st]]),c=b.pop();b.length&&!c.nextSibling;)c=b.pop();c.nextSibling&&b.push(c=c.nextSibling)}}for(o=0,a=r.length;a>o;o++){s=r[o],$=s[0],u=s[1],c=s[2],h=bn(c),n[h]=n[h]||{},n[h].keys=n[h].keys||{},y=n[h].keys;do d=u[1],v=$.splitText(u.index),$=v.splitText(u[0].length),(y[d]=y[d]||[]).push(v),u=$.nodeValue.match(t);while(u);c[G](i)||c[K](i,1)}for(m={},o=0,a=l.length;a>o;o++){if(s=l[o],f=s[0],u=s[1],c=s[2],h=bn(c),n[h]=n[h]||{},n[h].keys=n[h].keys||{},y=n[h].keys,n[h].atts=n[h].atts||{},k=n[h].atts,g=f.nodeValue,p=g in m)for(u=0;u<m[g][0].length;u++)k[m[g][0][u]].push([f,m[g][1]]);else{$=gt(g),m[g]=[[],[$]];do{if(d=u[1],!(g.length>u[0].length)){v=$,m[g][0].push(d),(y[d]=y[d]||[]).push(v),(k[d]=k[d]||[]).push([f,m[g][1]]);break}v=$.splitText(u.index),$=v.splitText(u[0].length),m[g][0].push(d),m[g][1].push(v),m[g][1].push($),(y[d]=y[d]||[]).push(v),(k[d]=k[d]||[]).push([f,m[g][1]]),u=$.nodeValue.match(t)}while(u)}c[G](i)||c[K](i,1)}}return n},wn=function(e,t,n){return[e?"["+e+"]":null,t?"["+t+"]":null,n?n[1]?'input[name="'+n[0]+'"],textarea[name="'+n[0]+'"],select[name="'+n[0]+'"]':'input[name^="'+n[0]+'"],textarea[name^="'+n[0]+'"],select[name^="'+n[0]+'"]':null]},En=function(e,t){return t&&t[e]?(J(t[e],A)&&(t[e]={action:t[e]}),t[e]):void 0},_n=function(e,t,n,i){var r,l,o,a,u,s,c=e.$model,f="sync"==n.type,d=f?"change":n.type,h=t.length,v=i&&i.key?i.key:null,m=v?v+".":null,p=c.atomic,g=c.$atom,$=p?g+".":null;for(r=0;h>r;r++)l=t[r],l&&(o=En(d,e.attr(l,"bind")),o&&o.action&&(a="do_"+o.action,J(e[a],z)&&(u=l[it],s=o.key,s||(!l[pn]&&u&&(l[pn]=c.key(u,1)),s=l[pn]),p&&s&&(g===s||Dt(s,$))||v&&!s||(!v||s===v||Dt(s,m))&&e[a](n,l,o))))},Tn=function(e,t,n){var i,r,l,o,a,u=e.$model,s={},c=t.length;for(i=0;c>i;i++)if(r=t[i],r&&(l=r[it],o=0,!r[pn]&&l&&(r[pn]=u.key(l,1)),o=r[pn])){if(s[o])a=s[o][0];else{if(!u.has(o))continue;s[o]=[a=u.get(o)]}e.do_bind(n,r,{name:l,key:o,value:a})}},Sn=function(e,t,n,i,r){var l,o,a,u,s,c,f,d,h,v,m,p,g,b,y=e.$model,k=t.length,w="sync"==n.type,E=e.$keynodes;if(E)if(i){for(m=i+".",r=""+r,o=0;k>o;o++)if(l=t[o],l&&(b=l[gn])&&E[b]){if(p=E[b].keys){if(u=p[i])for(a=0,s=u.length;s>a;a++)u[a].nodeValue=r;for(c=$(p),f=0,h=c.length;h>f;f++)if(d=c[f],i!==d&&Dt(d,m)&&(u=p[d]).length)for(v=""+y.get(d),a=0,s=u.length;s>a;a++)u[a].nodeValue=v}if(g=E[b].atts){if(g&&(u=g[i]))for(a=0,s=u.length;s>a;a++)u[a][0].nodeValue=mn(u[a][1]);for(c=$(g),f=0,h=c.length;h>f;f++)if(d=c[f],i!==d&&Dt(d,m)&&(u=g[d]).length)for(a=0,s=u.length;s>a;a++)u[a][0].nodeValue=mn(u[a][1])}}}else if(w)for(o=0;k>o;o++)if(l=t[o],l&&(b=l[gn])&&E[b]){if(p=E[b].keys)for(c=$(p),f=0,h=c.length;h>f;f++)if(d=c[f],(u=p[d])&&(s=u.length))for(v=""+y.get(d),a=0;s>a;a++)u[a].nodeValue=v;if(g=E[b].atts)for(c=$(g),f=0,h=c.length;h>f;f++)if(d=c[f],(u=g[d])&&(s=u.length))for(a=0;s>a;a++)u[a][0].nodeValue=mn(u[a][1])}},Cn=function(e,t,n,i,r){var l=this;return l instanceof Cn?(l.namespace=l.id=e||It("View"),"bind"in(n=n||{})||(n.bind="data-bind"),"keys"in n||(n.keys="data-mvkeys"+ ++$n),l.$atts=n,i=i||Cn._CACHE_SIZE,r=r||Cn._REFRESH_INTERVAL,l.$memoize=new qt(i,R),l.$selectors=new qt(i,r),l.$atbind=l.attribute("bind"),l.$atkeys=l.attribute("keys"),void l.model(t||new hn).initPubSub()):new Cn(e,t,n,i,r)};return Cn._CACHE_SIZE=600,Cn._REFRESH_INTERVAL=R,Cn[c]=Z(g(m[c]),Ut,{constructor:Cn,id:null,$dom:null,$model:null,$livebind:null,$autobind:!1,$bindbubble:!1,$template:null,$atts:null,$memoize:null,$selectors:null,$keynodes:null,$atbind:null,$atkeys:null,dispose:function(){var e=this;return e.unbind().disposePubSub(),e.$model&&e.$model.dispose(),e.$model=null,e.$dom=null,e.$template=null,e.$atts=null,e.$memoize.dispose(),e.$memoize=null,e.$selectors.dispose(),e.$selectors=null,e.$livebind=null,e.$keynodes=null,e.$atbind=null,e.$atkeys=null,e},model:function(e){var t=this;return arguments.length?(t.$model&&t.$model.dispose(),t.$model=e.view(t),t):t.$model},attribute:function(e,t){var n=this;return arguments.length>1?(n.$atts[e]=t,n.$atbind=n.$atts.bind,n.$atkeys=n.$atts.keys,n):e?n.$atts[e]||u:u},template:function(e){var t=this;return arguments.length?(J(e,z)&&(t.$template=e),t):t.$template},events:function(e){var t,n=this;if(J(e,I))for(t in e)J(e[t],z)&&(n["on_"+t.split(":").join("_")]=e[t]);return n},actions:function(e){var t,n=this;if(J(e,I))for(t in e)J(e[t],z)&&(n["do_"+t]=e[t]);return n},livebind:function(e){var t=this;return arguments.length?(t.$livebind=e?vn(e,t.$model?t.$model.id:""):null,t):t.$livebind},autobind:function(e){var t=this;return arguments.length?(t.$autobind=!!e,t):t.$autobind},bindbubble:function(e){var t=this;return arguments.length?(t.$bindbubble=!!e,t):t.$bindbubble},get:function(e,t,n,i){var r,l=this,o=l.$selectors;return t=t||l.$dom,(n||!(r=o.get(e)))&&(r=mt(e,t),i&&pt.call(t,e)&&r.push(t),n||o.set(e,r)),r},attr:function(e,t){var n,i,r=this,l=r.$atts[t],o=r.$memoize;return(l=e[G](l))?(n=o.get(l),u===n&&(n=Rt(l),n.set&&(n.click=n.set,n.click.action="set",L(n,"set")),n.show&&(n.change={action:"show",key:n.show},L(n,"show")),n.hide&&(n.change={action:"hide",key:n.hide},L(n,"hide")),n.html?(n.change={action:"html",key:n.html},L(n,"html"),L(n,"text")):n.text&&(n.change={action:"html",key:n.text,text:1},L(n,"text")),n.css&&(n.change={action:"css",css:n.css},L(n,"css")),n.value&&(n.change&&"prop"==n.change.action?n.change.prop.value=n.value:n.change={action:"prop",prop:{value:n.value}},L(n,"value")),n.checked&&(n.change&&"prop"==n.change.action?n.change.prop.checked=n.checked:n.change={action:"prop",prop:{checked:n.checked}},L(n,"checked")),n.disabled&&(n.change&&"prop"==n.change.action?n.change.prop.disabled=n.disabled:n.change={action:"prop",prop:{disabled:n.disabled}},L(n,"disabled")),n.options&&(n.change&&"prop"==n.change.action?n.change.prop.options=n.options:n.change={action:"prop",prop:{options:n.options}},L(n,"options")),(i=n.change)&&(!i.domRef&&n.domRef&&(i.domRef=n.domRef),!i.key&&n.key&&(i.key=n.key)),o.set(l,n)),n):u},getDomRef:function(e,t){return Dt(t,"$this::")?mt(t.slice(7),e,1):mt(t,null,1)},append:function(e,t){var n=this;return e&&(t=t||n.$dom,t.appendChild(e),n.$livebind&&(n.$keynodes=kn(e,n.$livebind,n.$keynodes,n.$atkeys)),n.sync(t,e)),n},remove:function(e){var t=this;return e&&(t.$keynodes=yn(e,t.$keynodes),e.parentNode.removeChild(e),t.$selectors.reset()),t},bind:function(e,n){var i,r,l,o=this,u=o.$model,s=wn(o.$atbind,o.$atkeys,[u.id+"["]),c=s[0],f=s[2],d=/^on_model_/;e=e||["change","click"],o.$dom=n||document.body,o.$livebind&&(o.$keynodes=kn(o.$dom,o.$livebind,null,o.$atkeys));for(i in o)J(o[i],z)&&d.test(i)&&(r=i.replace(d,""),r.length&&o.onTo(u,r,o[i]));return o.on_view_change&&e.length&&(l=function(e){return t(e,o.namespace)},a(o.$dom).on(e.map(l).join(" "),[f,c].join(","),function(e){var t=this,n=!1,i=!1,r=o.$bindbubble?o.attr(t,"bind"):null;return(e.target===t||r&&r.bubble)&&(i=o.$bindbubble?!!r:pt.call(t,c),n=o.$autobind&&"change"==e.type&&pt.call(t,f),(i||n)&&o.on_view_change(e,{el:t,isBind:i,isAutoBind:n})),!0})),o},unbind:function(e,n){var i,r,l=this,o=l.$model,u=wn(l.$atbind,l.$atkeys,[o.id+"["]);return e=e||null,r=n||l.$dom,l.on_view_change&&(i=function(e){return t(e,l.namespace)},a(r).off(e&&e.length?e.map(i).join(" "):t("",l.namespace),[u[2],u[0]].join(","))),l.offFrom(o),l.$keynodes=null,l},rebind:function(e,t){var n=this;return n.$memoize.reset(),n.$selectors.reset(),n.unbind().bind(e,t)},sync:function(e,t){var n,i,r,l,o,a=this,u=wn(a.$atbind,a.$atkeys,[a.$model.id+"["]),s=Bt("sync",a);return e=e||a.$dom,l=a.$autobind,o=!!a.$livebind,a.$selectors.reset(),t?(s.currentTarget=t,n=a.get(u[0],t,1,1),o&&(r=a.get(u[1],t,1,1)),l&&(i=a.get(u[2],t,1,1))):(n=a.get(u[0],e,1),o&&(r=a.get(u[1],e,1,1)),l&&(i=a.get(u[2],e,1))),n.length&&_n(a,n,s),o&&r.length&&Sn(a,r,s),l&&i.length&&Tn(a,i,s),a},reset:function(){var e=this;return e.$memoize.reset(),e.$selectors.reset(),e},on_view_change:function(e,t){var n,i,r,l,o=this,a=o.$model,u=t.el,s={};t.isAutoBind&&(n=u[it])&&(u[pn]||(u[pn]=a.key(n,1)),i=u[pn],i&&a.has(i)&&("checkbox"===u[lt].toLowerCase()?(l=o.get('input[type="checkbox"][name="'+n+'"]'),l.length>1?(r=[],l.forEach(function(e){r.push(e[et]?e[ot]:"")})):r=u[et]?u[ot]:""):r=_t(u),s.$trigger=u,a.set(i,r,1,s))),!s.error&&t.isBind&&_n(o,[u],e),o.publish("change",t)
},on_model_change:function(e,t){var n,i,r,l,o=this,a=o.$model,u=wn(o.$atbind,o.$atkeys,[a.id+an(t.key)]),s=o.$autobind,c=!!o.$livebind;n=o.get(u[0]),c&&(r=o.get(u[1],0,0,1)),s&&(i=o.get(u[2])),t.$callData&&t.$callData.$trigger&&(l=function(e){return e!==t.$callData.$trigger},n=n.filter(l),s&&(i=i.filter(l)),t.$callData=null),n.length&&_n(o,n,e,t),c&&r.length&&Sn(o,r,e,t.key,t.value),s&&i.length&&Tn(o,i,e,t)},on_model_error:function(e,t){var n,i,r,l=this,o=l.$model,a=wn(l.$atbind,l.$atkeys,[o.id+an(t.key)]);(n=l.get(a[0])).length&&_n(l,n,e,t),l.$livebind&&(r=l.get(a[1],0,0,1)).length&&Sn(l,r,e,t.key,t.value),l.$autobind&&(i=l.get(a[2])).length&&Tn(l,i,e,t)},do_nop:null,do_prop:function(e,t,n){if(J(n.prop,I)){var i,r,l,o,a=this,u=a.$model,s=n.prop;if(n.domRef&&(t=a.getDomRef(t,n.domRef)[0]),t)for(i in s)if(r=s[i],u.has(r))switch(l=u.get(r),o=X(l),i){case"value":Tt(t,l);break;case"checked":case"disabled":t[i]=M===o?l:k(l)==t[ot];break;case"options":if("select"===t[rt]&&P===o){var c,f,d=l.length,h="",v=vt("optgroup",t);for(c=wt(t),v=v.length?v[0]:t,vt("option",v).forEach(function(e){v.removeChild(e)}),f=0;d>f;f++)h+=l[f]&&l[f].label?'<option value="'+l[f].value+'">'+l[f].label+"</option>":'<option value="'+l[f]+'">'+l[f]+"</option>";v[ft]=h,Et(t,c)}break;default:t[K](i,l)}}},do_html:function(e,t,n){if(n.key){var i=this,r=i.$model,l=n.key;n.domRef&&(t=i.getDomRef(t,n.domRef)[0]),t&&l&&r.has(l)&&(t[n.text?ht in t?ht:dt:ft]=r.get(l))}},do_css:function(e,t,n){if(J(n.css,I)){var i,r,l,o=this,a=o.$model,u=n.css;if(n.domRef&&(t=o.getDomRef(t,n.domRef)[0]),t)for(r in u)i=u[r],l=a.get(i),l&&(t.style[r]=l)}},do_set:function(e,t,n){var i,r=this,l=r.$model,o=null;n.key?o=n.key:t[it]&&(t[pn]||(t[pn]=l.key(t[it],1)),o=t[pn]),o&&("value"in n?i=n.value:(n.domRef&&(t=r.getDomRef(t,n.domRef)[0]),i=_t(t)),l.set(o,i,1))},do_tpl:function(e,t,n){var i,r,l,o=this,a=n.key,u=n.tpl;o.$template&&a&&u&&(n.domRef&&(t=o.getDomRef(t,n.domRef)[0]),t&&(i=o.$model,a&&i.has(a)&&(r=n.mode||"replace","replace"==r&&(t[ft]=""),l=o.$template(u,i.get(a)),l&&(t[ft]+=l))))},do_show:function(e,t,n){var i=this,r=i.$model,l=n.key;n.domRef&&(t=i.getDomRef(t,n.domRef)[0]),t&&l&&("value"in n?n.value===r.get(l)?bt(t):yt(t):r.get(l)?bt(t):yt(t))},do_hide:function(e,t,n){var i=this,r=i.$model,l=n.key;n.domRef&&(t=i.getDomRef(t,n.domRef)[0]),t&&l&&("value"in n?n.value===r.get(l)?yt(t):bt(t):r.get(l)?yt(t):bt(t))},do_bind:function(e,t,n){var i,r,l=this,o=(l.$model,n.name),a=n.key,u=t[lt].toLowerCase();if(a)if(i=n.value,r=X(i),"radio"===u)k(i)==t[ot]&&(l.get('input[name="'+o+'"]').forEach(function(e){t!==e&&(e[et]=!1)}),t[et]=!0);else if("checkbox"===u){var s=l.get('input[type="checkbox"][name="'+o+'"]');s.length>1&&P===r?s.forEach(function(e){e[et]=-1<i.indexOf(e[ot])?!0:!1}):t[et]=M===r?i:k(i)==t[ot]}else Tt(t,i)},toString:function(){return"[ModelView.View id: "+this.id+"]"}}),e.ModelView={VERSION:"0.42",UUID:It,Extend:Z,Field:Wt,Type:Zt,Validation:Gt,Cache:qt,Model:hn,View:Cn},!function(e,t){e.jquery=function(t){if(!t.ModelView){t.ModelView=e;var n=(Function.prototype.call.bind(Array.prototype.slice),t.extend),i=e.View,r=e.Model,l={id:"model",data:{},types:{},validators:{},getters:{},setters:{}},o={viewClass:i,modelClass:r,id:"view",bindAttribute:"data-bind",livebind:null,autobind:!1,bindbubble:!1,events:null,autoSync:!0,cacheSize:i._CACHE_SIZE,refreshInterval:i._REFRESH_INTERVAL,model:null,template:null,actions:{},handlers:{}};t.fn.modelview=function(e,i){var a=arguments.length,u=a?e:null,s=e,c=!0,f=!1,d=[];return this.each(function(){var e,h,v=t(this);if(v.data("modelview")){if(c=!1,h=v.data("modelview"),e=h.$model,"view"===u)d.push(h);else if("model"===u){if(a>1)return h.model(i),this;d.push(e)}else if("data"===u){if(a>1)return e.data(i),this;d.push(e.data())}else"sync"===u?h.sync(i):"reset"===u?h.reset():"dispose"===u&&(v.data("modelview",null),h.dispose());return this}return f||(s=n({},o,s),!s.model||s.model instanceof r||(s.model=n({},l,s.model)),f=!0),s.model?(e=s.model instanceof r?s.model:new s.modelClass(s.model.id,s.model.data,s.model.types,s.model.validators,s.model.getters,s.model.setters),h=new s.viewClass(s.id,e,{bind:s.bindAttribute||"data-bind"},s.cacheSize,s.refreshInterval).template(s.template).events(s.handlers).actions(s.actions).livebind(s.livebind).autobind(s.autobind).bindbubble(s.bindbubble).bind(s.events,v[0]),v.data("modelview",h),void(s.autoSync&&h.sync())):this}),!c&&d.length?1==this.length?d[0]:d:this}}!t.widget||t.mvc&&t.mvc.ModelViewWidget||t.widget("mvc.ModelViewWidget",{options:{},$view:null,_create:function(){var e=this;e.element.modelview(e.options),e.$view=e.element.modelview("view")},value:function(e,t){var n=this;return 1<arguments.length?(n.$view.$model.set(e,t,!0),n.element):n.$view.$model.get(e)},_destroy:function(){var e=this.self.$view=null;e.element.modelview("dispose")}})},"undefined"!=typeof t.jQuery&&e.jquery(t.jQuery)}(e.ModelView,this),e.ModelView});
